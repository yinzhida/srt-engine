{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 33400983b5aa532c9129","webpack:///external \"babel-runtime/helpers/classCallCheck\"","webpack:///external \"babel-runtime/helpers/createClass\"","webpack:///./src/js/utils/logger.js","webpack:///external \"babel-runtime/core-js/get-iterator\"","webpack:///./src/js/utils/time.js","webpack:///./src/js/utils/guid.js","webpack:///./src/js/config/constants.js","webpack:///external \"babel-runtime/regenerator\"","webpack:///external \"babel-runtime/helpers/asyncToGenerator\"","webpack:///./src/js/index.js","webpack:///./src/js/clazz/srt-engine.js","webpack:///./src/js/utils/single.js","webpack:///external \"lodash.clonedeep\"","webpack:///./src/js/utils/srt.js","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///./src/js/dao/dao.js","webpack:///external \"babel-runtime/core-js/object/assign\"","webpack:///external \"babel-runtime/core-js/json/stringify\"","webpack:///./src/js/utils/common-util.js","webpack:///external \"query-string\"","webpack:///external \"lodash.merge\"","webpack:///./src/js/utils/data-cache.js","webpack:///external \"babel-runtime/core-js/map\""],"names":["Logger","component","name","debug","process","log","method","data","Date","toUTCString","information","warning","warn","error","getLogger","getClassSingleton","formatTime","secondtime","formatString","frameRate","test","console","timeKey","regString","Math","floor","timeNumbers","getTimeNumbers","i","len","replace","RegExp","matchString","index","originalString","formatNumber","length","milli","frame","toFixed","timeArray","split","milliSecond","round","Number","hour","minute","second","totalSeconds","firstRemain","number","n","numberArray","unshift","res","join","_guid","newGUID","WILL_BUILD_INDEX_COUNT","UID_INDEX_GROUP_SIZE","ITME_INDEX_GROUP_DURATION","SrtEngine","shouldBuildIndex","logger","content","url","timeIndexGroup","uidIndexGroup","getSubtitleTextArrayByUrl","constants","buildIndex","text","getTextArrayFromText","styles","result","id","startTimeInMilliSeconds","endTimeInMilliSeconds","getStyledTexts","texts","supportStyles","value","serialize","getPureText","style","styleValue","map","_addToIndex","_addToTimeIndex","_addToUidIndex","_removeFromTimeIndex","_removeFromUidIndex","levelKey","getTimeLevelKey","endLevelKey","push","getUidLevelKey","uid","currentGroup","dataIndex","findIndex","item","splice","currentEndGroup","endDataIndex","milliSecondtime","find","deleted","parseInt","word","searchResult","indexOf","info","findByUid","originData","cloneDeep","needUpdateTimeIndex","_removeFromIndex","sort","a","b","filter","Clazz","arguments","getMilliSecondsFromString","timeStr","timeDivide","otherTimeStr","hmsArray","lineArray","marker","dataArray","timeArr","trim","isNaN","Error","contentLineNumber","divideLineNumber","originText","e","toString","cacheUtil","DataCache","getInstanceByname","textArray","getData","fetchBlob","then","blob","resolve","reject","reader","FileReader","onload","add","readAsText","checkCode","json","code","message","msg","isFetchSuccess","fetchFactory","options","startTime","now","performance","request","endTime","response","timing","trans","merge","mode","headers","Headers","toUpperCase","queryString","stringify","type","set","body","fetch","GET","POST","fetchText","fetchJSON","fetchArrayBuffer","arrayBuffer","SUCCESS_CODE","hasAuth","auth","cutomGlobal","global","window","GLOBAL","auths","includes","setObjArrayAttributeValue","objArray","attributeName","attributeValue","singleValue","obj","undefined","getObjArrayAttributeIndexs","closeWebPage","navigator","userAgent","opener","close","open","top","location","href","generateRandom","min","max","random","instances","maxQueue","has","dataCacheQueue","maxCacheNumber","key","queue","shift","dataMap","get","getDataByKey"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,KAAK;QACL;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;QAEA;QACA;;;;;;;AC7DA,iE;;;;;;ACAA,8D;;;;;;;;;;;;;;ACAA;;;;;;;;;AASA;;IAEMA,M;AACJ,kBAAaC,SAAb,EAAwB;AAAA;;AACtB,SAAKC,IAAL,GAAYD,SAAZ;AACA,SAAKE,KAAL,GAAaC,YAAA,KAAyB,YAAtC;AACD;;;;0BAEa;AACZ,UAAI,KAAKD,KAAT,EAAgB;AAAA;;AACd,6BAAQE,GAAR;AACD;AACF;;;0BAEMC,M,EAAiB;AAAA,wCAANC,IAAM;AAANA,YAAM;AAAA;;AACtB,WAAKF,GAAL,yCAAkC,IAAIG,IAAJ,GAAWC,WAAX,EAAlC,qBAA0E,KAAKP,IAA/E,mBAAiGI,MAAjG,gBAAoH,cAApH,SAAuIC,IAAvI;AACD;;;yBAEKD,M,EAAwB;AAAA,yCAAbI,WAAa;AAAbA,mBAAa;AAAA;;AAC5B,WAAKL,GAAL,4BAAqB,IAAIG,IAAJ,GAAWC,WAAX,EAArB,qBAA6D,KAAKP,IAAlE,mBAAoFI,MAApF,uBAA8G,eAA9G,SAAkII,WAAlI;AACD;;;yBAEKJ,M,EAAoB;AAAA;;AAAA,yCAATK,OAAS;AAATA,eAAS;AAAA;;AACxB,4BAAQC,IAAR,kCAA0B,IAAIJ,IAAJ,GAAWC,WAAX,EAA1B,qBAAkE,KAAKP,IAAvE,mBAAyFI,MAAzF,0BAAkHK,OAAlH;AACD;;;0BAEML,M,EAAkB;AAAA;;AAAA,yCAAPO,MAAO;AAAPA,cAAO;AAAA;;AACvB,4BAAQA,KAAR,gCAAyB,IAAIL,IAAJ,GAAWC,WAAX,EAAzB,qBAAiE,KAAKP,IAAtE,mBAAwFI,MAAxF,wBAA+GO,MAA/G;AACD;;;;;;AAGH,IAAMC,YAAYC,gEAAiBA,CAACf,MAAlB,CAAlB;;AAEec,kEAAf,E;;;;;;AC1CA,+D;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;;AASA;;;;;;AAMA,IAAME,aAAa,SAAbA,UAAa,CAACC,UAAD,EAAaC,YAAb,EAA2BC,SAA3B,EAAyC;AAC1DD,iBAAeA,gBAAgB,YAA/B;;AAEA,MAAI,UAAUE,IAAV,CAAeF,YAAf,CAAJ,EAAkC;AAChCG,YAAQR,KAAR,CAAc,YAAd,EAA4B,sBAA5B;AACA;AACD;;AAED,MAAIS,UAAU,CAAC;AACbpB,UAAM,MADO;AAEbqB,eAAW;AAFE,GAAD,EAGX;AACDrB,UAAM,QADL;AAEDqB,eAAW;AAFV,GAHW,EAMX;AACDrB,UAAM,QADL;AAEDqB,eAAW;AAFV,GANW,CAAd;;AAWA,MAAI,CAAC,MAAMH,IAAN,CAAWF,YAAX,CAAL,EAA+B;AAC7BD,iBAAaO,KAAKC,KAAL,CAAWR,UAAX,CAAb;AACD;;AAED,MAAIS,cAAcC,eAAeV,UAAf,EAA2BE,SAA3B,CAAlB;;AAvB0D,6BAyBjDS,CAzBiD,EAyB1CC,GAzB0C;AA0BxDX,mBAAeA,aAAaY,OAAb,CAAqB,IAAIC,MAAJ,CAAWT,QAAQM,CAAR,EAAWL,SAAtB,CAArB,EAAuD,UAAUS,WAAV,EAAuBC,KAAvB,EAA8BC,cAA9B,EAA8C;AAClH,aAAOC,aAAaT,YAAYJ,QAAQM,CAAR,EAAW1B,IAAvB,CAAb,EAA2C8B,YAAYI,MAAvD,CAAP;AACD,KAFc,CAAf;AA1BwD;;AAyB1D,OAAK,IAAIR,IAAI,CAAR,EAAWC,MAAMP,QAAQc,MAA9B,EAAsCR,IAAIC,GAA1C,EAA+CD,GAA/C,EAAoD;AAAA,UAA3CA,CAA2C,EAApCC,GAAoC;AAInD;;AAED;AACAX,iBAAeA,aAAaY,OAAb,CAAqB,GAArB,EAA0BK,aAAaT,YAAYW,KAAzB,EAAgC,CAAhC,CAA1B,CAAf;AACAnB,iBAAeA,aAAaY,OAAb,CAAqB,GAArB,EAA0BK,aAAaT,YAAYY,KAAzB,CAA1B,CAAf;AACA,SAAOpB,YAAP;AACD,CAnCD;;AAqCA;;;;;AAKA,IAAMS,iBAAiB,SAAjBA,cAAiB,CAACV,UAAD,EAAgC;AAAA,MAAnBE,SAAmB,uEAAP,EAAO;;AACrD;AACAF,eAAaA,WAAWsB,OAAX,CAAmB,CAAnB,CAAb;AACA;AACA,MAAIC,YAAYvB,WAAWwB,KAAX,CAAiB,GAAjB,CAAhB;AACA;AACA,MAAIC,cAAc,CAAlB;AACA,MAAIJ,QAAQ,CAAZ;AACA,MAAIE,UAAU,CAAV,CAAJ,EAAkB;AAChBE,kBAAclB,KAAKmB,KAAL,CAAWC,OAAO,OAAOJ,UAAU,CAAV,CAAd,IAA8B,IAAzC,CAAd;AACAF,YAAQd,KAAKC,KAAL,CAAWiB,eAAe,OAAOvB,SAAtB,CAAX,CAAR;AACD;AACD;AACA,MAAI0B,OAAO,CAAX;AACA,MAAIC,SAAS,CAAb;AACA,MAAIC,SAAS,CAAb;AACA;AACA,MAAIC,eAAeJ,OAAOJ,UAAU,CAAV,CAAP,CAAnB;AACA;AACAK,SAAOrB,KAAKC,KAAL,CAAWuB,eAAe,IAA1B,CAAP;AACA;AACA,MAAIC,cAAcD,eAAe,IAAjC;AACA;AACAF,WAAStB,KAAKC,KAAL,CAAWwB,cAAc,EAAzB,CAAT;AACA;AACAF,WAASE,cAAc,EAAvB;;AAEA,MAAIvB,cAAc;AAChBmB,UAAMA,IADU;AAEhBC,YAAQA,MAFQ;AAGhBC,YAAQA,MAHQ;AAIhBV,WAAOK,WAJS;AAKhBJ,WAAOA;AALS,GAAlB;;AAQA,SAAOZ,WAAP;AACD,CApCD;;AAsCA;;;;;;AAMA,IAAMS,eAAe,SAAfA,YAAe,CAACe,MAAD,EAASC,CAAT,EAAe;AAClCA,MAAIA,KAAK,CAAT;AACAD,WAASA,SAAS,EAAlB;AACA,MAAIE,cAAcF,OAAOT,KAAP,CAAa,EAAb,CAAlB;;AAEA,MAAIW,YAAYhB,MAAZ,GAAqBe,CAAzB,EAA4B;AAC1B,QAAItB,MAAMsB,IAAIC,YAAYhB,MAA1B;AACA,SAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5BwB,kBAAYC,OAAZ,CAAoB,GAApB;AACD;AACF;;AAED,MAAIC,MAAMF,YAAYG,IAAZ,CAAiB,EAAjB,CAAV;AACA,SAAOD,GAAP;AACD,CAdD;;;;;;;;;ACrGA;;;;;AAKA;;;;AAIA,IAAIE,QAAQ,CAAZ;;AAEA;;;;;;AAMA,IAAMC,UAAU,SAASA,OAAT,GAAoB;AAClC,SAAOD,OAAP;AACD,CAFD;;AAIeC,gEAAf,E;;;;;;;;;ACnBe;AACbC,0BAAwB,EADX;AAEbC,wBAAsB,EAFT;AAGbC,6BAA2B,OAAO,EAAP,GAAY,EAH1B,CAG8B;AAH9B,CAAf,E;;;;;;ACFA,sD;;;;;;ACAA,mE;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;;IAEMC,S;AACJ,qBAAaC,gBAAb,EAA+B;AAAA;;AAC7B,SAAKC,MAAL,GAAcjD,yEAASA,CAAC,WAAV,CAAd;AACA,SAAKkD,OAAL,GAAe,EAAf;AACA,SAAKC,GAAL,GAAW,IAAX;AACA,SAAKH,gBAAL,GAAwB,OAAOA,gBAAP,KAA4B,SAA5B,GAAwCA,gBAAxC,GAA2D,IAAnF;AACA,SAAKI,cAAL,GAAsB,IAAtB;AACA,SAAKC,aAAL,GAAqB,IAArB;AACD;;;;yBAEKF,G,EAAK;AACT,WAAKA,GAAL,GAAWA,GAAX;AACA,WAAKD,OAAL,GAAeI,wFAAyBA,CAACH,GAA1B,CAAf;AACA,UAAI,KAAKH,gBAAL,IAAyB,KAAKE,OAAL,CAAa5B,MAAb,GAAsBiC,qEAASA,CAACX,sBAA7D,EAAqF;AACnF,aAAKY,UAAL;AACD;AACD,aAAO,IAAP;AACD;;;4BAEQC,I,EAAM;AACb,WAAKN,GAAL,GAAW,EAAX;AACA,WAAKD,OAAL,GAAeQ,mFAAoBA,CAACD,IAArB,CAAf;AACA,UAAI,KAAKT,gBAAL,IAAyB,KAAKE,OAAL,CAAa5B,MAAb,GAAsBiC,qEAASA,CAACX,sBAA7D,EAAqF;AACnF,aAAKY,UAAL;AACD;AACD,aAAO,IAAP;AACD;;;8BAEUG,M,EAAQ;AACjB,UAAIC,SAAS,EAAb;AACA,UAAI7C,MAAM,KAAKmC,OAAL,CAAa5B,MAAvB;AACA,WAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,YAAIrB,OAAO,KAAKyD,OAAL,CAAapC,CAAb,CAAX;AACA,YAAI+C,KAAK/C,IAAI,CAAb;AACA8C,kBAAUC,KAAK,IAAf;AACAD,kBAAU1D,0EAAUA,CAAET,KAAKqE,uBAAL,GAA+B,IAA3C,EAAkD,YAAlD,CAAV;AACAF,kBAAU,OAAV;AACAA,kBAAU1D,0EAAUA,CAAET,KAAKsE,qBAAL,GAA6B,IAAzC,EAAgD,YAAhD,CAAV;AACAH,kBAAU,IAAV;AACAA,kBAAU,KAAKI,cAAL,CAAoBvE,KAAKwE,KAAzB,EAAgCN,MAAhC,EAAwClB,IAAxC,CAA6C,IAA7C,IAAqD,MAA/D;AACD;AACD,aAAOmB,MAAP;AACD;;;mCAEeK,K,EAAON,M,EAAQ;AAC7B,UAAMO,gBAAgB,CAAC;AACrB9E,cAAM,WADe;AAErBI,cAFqB,kBAEbiE,IAFa,EAEPU,KAFO,EAEA;AACnB,mCAAuBA,KAAvB,UAAiCV,IAAjC;AACD;AAJoB,OAAD,EAKnB;AACDrE,cAAM,UADL;AAEDI,cAFC,kBAEOiE,IAFP,EAEaU,KAFb,EAEoB;AACnB,cAAI,kBAAkB7D,IAAlB,CAAuBmD,IAAvB,CAAJ,EAAkC;AAChCA,iBAAKzC,OAAL,CAAa,OAAb,kBAAoCmD,KAApC;AACD,WAFD,MAEO;AACL,oCAAsBA,KAAtB,UAAgCV,IAAhC;AACD;AACF;AARA,OALmB,EAcnB;AACDrE,cAAM,MADL;AAEDI,cAFC,kBAEOiE,IAFP,EAEaU,KAFb,EAEoB;AACnB,yBAAaV,IAAb;AACD;AAJA,OAdmB,EAmBnB;AACDrE,cAAM,QADL;AAEDI,cAFC,kBAEOiE,IAFP,EAEaU,KAFb,EAEoB;AACnB,yBAAaV,IAAb;AACD;AAJA,OAnBmB,EAwBnB;AACDrE,cAAM,aADL;AAEDI,cAFC,kBAEOiE,IAFP,EAEaU,KAFb,EAEoB;AACnB,yBAAaV,IAAb;AACD;AAJA,OAxBmB,EA6BnB;AACDrE,cAAM,OADL;AAEDI,cAFC,kBAEOiE,IAFP,EAEaU,KAFb,EAEoB;AACnB,2BAAeA,KAAf,SAAwBV,IAAxB;AACD;AAJA,OA7BmB,CAAtB;;AAoCA,UAAMW,YAAY,SAAZA,SAAY,CAACX,IAAD,EAAU;AAC1BA,eAAOY,0EAAWA,CAACZ,IAAZ,CAAP;AAD0B;AAAA;AAAA;;AAAA;AAE1B,0GAAkBS,aAAlB,4GAAiC;AAAA,gBAAxBI,KAAwB;;AAC/B,gBAAIC,aAAaZ,OAAOW,MAAMlF,IAAb,CAAjB;AACA,gBAAImF,UAAJ,EAAgB;AACdd,qBAAOa,MAAM9E,MAAN,CAAaiE,IAAb,EAAmBc,UAAnB,CAAP;AACD;AACF;AAPyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQ3B,OARD;;AAUAN,YAAMO,GAAN,CAAUJ,SAAV;AACD;;;iCAEa;AACZ,UAAMrD,MAAM,KAAKmC,OAAL,CAAa5B,MAAzB;AACA,WAAK8B,cAAL,GAAsB,EAAtB;AACA,WAAKC,aAAL,GAAqB,EAArB;AACA,WAAK,IAAIvC,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,YAAMrB,OAAO,KAAKyD,OAAL,CAAapC,CAAb,CAAb;AACA,aAAK2D,WAAL,CAAiBhF,IAAjB;AACD;AACD,aAAO,IAAP;AACD;;;gCAEYA,I,EAAM;AACjB,WAAKiF,eAAL,CAAqBjF,IAArB;AACA,WAAKkF,cAAL,CAAoBlF,IAApB;AACD;;;qCAEiBA,I,EAAM;AACtB,WAAKmF,oBAAL,CAA0BnF,IAA1B;AACA,WAAKoF,mBAAL,CAAyBpF,IAAzB;AACD;;;oCAEgBA,I,EAAM;AACrB,UAAMqF,WAAW,KAAKC,eAAL,CAAqBtF,KAAKqE,uBAA1B,CAAjB;AACA,UAAMkB,cAAc,KAAKD,eAAL,CAAqBtF,KAAKsE,qBAA1B,CAApB;AACA,WAAKX,cAAL,CAAoB0B,QAApB,IAAgC,KAAK1B,cAAL,CAAoB0B,QAApB,KAAiC,EAAjE;AACA,WAAK1B,cAAL,CAAoB0B,QAApB,EAA8BG,IAA9B,CAAmCxF,IAAnC;AACA,UAAIqF,aAAaE,WAAjB,EAA8B;AAC5B,aAAK5B,cAAL,CAAoB4B,WAApB,IAAmC,KAAK5B,cAAL,CAAoB4B,WAApB,KAAoC,EAAvE;AACA,aAAK5B,cAAL,CAAoB4B,WAApB,EAAiCC,IAAjC,CAAsCxF,IAAtC;AACD;AACF;;;mCAEeA,I,EAAM;AACpB,UAAMqF,WAAW,KAAKI,cAAL,CAAoBzF,KAAK0F,GAAzB,CAAjB;AACA,WAAK/B,cAAL,CAAoB0B,QAApB,IAAgC,KAAK1B,cAAL,CAAoB0B,QAApB,KAAiC,EAAjE;AACA,WAAK1B,cAAL,CAAoB0B,QAApB,EAA8BG,IAA9B,CAAmCxF,IAAnC;AACD;;;yCAEqBA,I,EAAM;AAC1B,UAAMqF,WAAW,KAAKC,eAAL,CAAqBtF,KAAKqE,uBAA1B,CAAjB;AACA,UAAMkB,cAAc,KAAKD,eAAL,CAAqBtF,KAAKsE,qBAA1B,CAApB;;AAEA,UAAIqB,eAAe,KAAKhC,cAAL,CAAoB0B,QAApB,CAAnB;AACA,UAAIO,YAAYD,aAAaE,SAAb,CAAuB;AAAA,eAAQC,KAAKJ,GAAL,KAAa1F,KAAK0F,GAA1B;AAAA,OAAvB,CAAhB;AACAC,mBAAaI,MAAb,CAAoBH,SAApB,EAA+B,CAA/B;;AAEA,UAAIP,aAAaE,WAAjB,EAA8B;AAC5B,YAAIS,kBAAkB,KAAKrC,cAAL,CAAoB4B,WAApB,CAAtB;AACA,YAAIU,eAAeD,gBAAgBH,SAAhB,CAA0B;AAAA,iBAAQC,KAAKJ,GAAL,KAAa1F,KAAK0F,GAA1B;AAAA,SAA1B,CAAnB;AACAM,wBAAgBD,MAAhB,CAAuBE,YAAvB,EAAqC,CAArC;AACD;AACF;;;wCAEoBjG,I,EAAM;AACzB,UAAIqF,WAAW,KAAKI,cAAL,CAAoBzF,KAAK0F,GAAzB,CAAf;AACA,UAAIC,eAAe,KAAK/B,aAAL,CAAmByB,QAAnB,CAAnB;AACA,UAAIO,YAAYD,aAAaE,SAAb,CAAuB;AAAA,eAAQC,KAAKJ,GAAL,KAAa1F,KAAK0F,GAA1B;AAAA,OAAvB,CAAhB;AACAC,mBAAaI,MAAb,CAAoBH,SAApB,EAA+B,CAA/B;AACD;;;+BAEWM,e,EAAiB;AAC3B,UAAI,KAAKvC,cAAT,EAAyB;AAAE;AACzB,YAAM0B,WAAW,KAAKC,eAAL,CAAqBY,eAArB,CAAjB;AACA,eAAO,KAAKvC,cAAL,CAAoB0B,QAApB,EAA8Bc,IAA9B,CAAmC,UAACL,IAAD,EAAU;AAClD,iBAAOA,KAAKzB,uBAAL,GAA+B6B,eAA/B,IACLJ,KAAKxB,qBAAL,GAA6B4B,eADxB,IAEL,CAACJ,KAAKM,OAFR;AAGD,SAJM,CAAP;AAKD,OAPD,MAOO;AAAE;AACP,YAAI9E,MAAM,KAAKmC,OAAL,CAAa5B,MAAvB;AACA,aAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,cAAIrB,OAAO,KAAKyD,OAAL,CAAapC,CAAb,CAAX;AACA,cAAIrB,KAAKqE,uBAAL,GAA+B6B,eAA/B,IACFlG,KAAKsE,qBAAL,GAA6B4B,eAD3B,IAEF,CAAClG,KAAKoG,OAFR,EAEiB;AACf,mBAAOpG,IAAP;AACD;AACF;AACF;AACF;;;oCAEgBkG,e,EAAiB;AAChC,aAAOG,SAASH,kBAAkBpC,qEAASA,CAACT,yBAArC,CAAP;AACD;;;mCAEeqC,G,EAAK;AACnB,aAAOW,SAASX,MAAM5B,qEAASA,CAACV,oBAAzB,CAAP;AACD;;;+BAEWkD,I,EAAM;AAChB,UAAIC,eAAe,EAAnB;AACA,UAAIjF,MAAM,KAAKmC,OAAL,CAAa5B,MAAvB;;AAEA,WAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,YAAIrB,OAAO,KAAKyD,OAAL,CAAapC,CAAb,CAAX;AACA,YAAI,CAACrB,KAAKoG,OAAN,IAAiBpG,KAAKwE,KAAL,CAAWxB,IAAX,CAAgB,IAAhB,EAAsBwD,OAAtB,CAA8BF,IAA9B,MAAwC,CAAC,CAA9D,EAAiE;AAC/DC,uBAAaf,IAAb,CAAkBxF,IAAlB;AACD;AACF;;AAED,aAAOuG,YAAP;AACD;;;8BAEUb,G,EAAK;AACd,UAAI,KAAK/B,cAAT,EAAyB;AAAE;AACzB,YAAI0B,WAAW,KAAKI,cAAL,CAAoBC,GAApB,CAAf;AACA,eAAO,KAAK9B,aAAL,CAAmByB,QAAnB,EAA6Bc,IAA7B,CAAkC,UAACL,IAAD,EAAU;AACjD,iBAAOA,KAAKJ,GAAL,KAAaA,GAAb,IAAoB,CAACI,KAAKM,OAAjC;AACD,SAFM,CAAP;AAGD,OALD,MAKO;AAAE;AACP,YAAI9E,MAAM,KAAKmC,OAAL,CAAa5B,MAAvB;AACA,aAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,cAAIrB,OAAO,KAAKyD,OAAL,CAAapC,CAAb,CAAX;AACA,cAAIrB,KAAK0F,GAAL,KAAaA,GAAb,IAAoB,CAAC1F,KAAKoG,OAA9B,EAAuC;AACrC,mBAAOpG,IAAP;AACD;AACF;AACF;AACF;;;sCAE8E;AAAA,UAAhEqE,uBAAgE,QAAhEA,uBAAgE;AAAA,UAAvCC,qBAAuC,QAAvCA,qBAAuC;AAAA,UAAhBE,KAAgB,QAAhBA,KAAgB;AAAA,UAAT9C,KAAS,QAATA,KAAS;;AAC7E,UAAI1B,OAAO;AACT0F,aAAKxC,uEAAOA,EADH;AAETkB,YAAI,IAFK;AAGTC,wDAHS;AAITC,oDAJS;AAKTE;AALS,OAAX;AAOA,WAAKf,OAAL,CAAasC,MAAb,CAAoBrE,KAApB,EAA2B,CAA3B,EAA8B1B,IAA9B;AACA,UAAI,KAAKuD,gBAAT,EAA2B;AACzB,YAAI,KAAKI,cAAL,KAAwB,IAAxB,IAAgC,KAAKC,aAAL,KAAuB,IAA3D,EAAiE;AAC/D,eAAKoB,WAAL,CAAiBhF,IAAjB;AACD,SAFD,MAEO;AACL,eAAK+D,UAAL;AACD;AACF;AACD,aAAO,IAAP;AACD;;;wCAEoB2B,G,EAAKe,I,EAAM;AAC9B,UAAIzG,OAAO,KAAK0G,SAAL,CAAehB,GAAf,CAAX;AACA,UAAMiB,aAAaC,wDAASA,CAAC5G,IAAV,CAAnB;AACA,UAAI6G,sBAAsB,KAA1B;;AAEA,UAAI,OAAOJ,KAAKpC,uBAAZ,KAAwC,QAA5C,EAAsD;AACpDwC,8BAAsB,IAAtB;AACA7G,aAAKqE,uBAAL,GAA+BoC,KAAKpC,uBAApC;AACD;;AAED,UAAI,OAAOoC,KAAKnC,qBAAZ,KAAsC,QAA1C,EAAoD;AAClDuC,8BAAsB,IAAtB;AACA7G,aAAKsE,qBAAL,GAA6BmC,KAAKnC,qBAAlC;AACD;;AAED,UAAI,KAAKX,cAAL,KAAwB,IAAxB,IAAgCkD,mBAApC,EAAyD;AACvD,aAAKC,gBAAL,CAAsBH,UAAtB;AACA,aAAK3B,WAAL,CAAiBhF,IAAjB;AACD;;AAEDA,WAAKwE,KAAL,GAAaiC,KAAKjC,KAAlB;AACD;;;wCAEoBkB,G,EAAK;AACxB,UAAI1F,OAAO,KAAK0G,SAAL,CAAehB,GAAf,CAAX;AACA1F,WAAKoG,OAAL,GAAe,IAAf;AACD;;;2BAEO;AACN,WAAK3C,OAAL,CAAasD,IAAb,CAAkB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC1B,eAAOD,EAAE3C,uBAAF,GAA4B4C,EAAE5C,uBAArC;AACD,OAFD;AAGD;;;iCAEa;AACZ,aAAOuC,wDAASA,CAAC,KAAKnD,OAAL,CAAayD,MAAb,CAAoB;AAAA,eAAQ,CAACpB,KAAKM,OAAd;AAAA,OAApB,EAA2CrB,GAA3C,CAA+C,UAACe,IAAD,EAAU;AACxEA,aAAKtB,KAAL,CAAWO,GAAX,CAAeH,kEAAf;AACA,eAAOkB,IAAP;AACD,OAHgB,CAAV,CAAP;AAID;;;;;;AAGYxC,kEAAf,E;;;;;;;AC1RA;;;;;;;;;AASA,IAAM9C,oBAAoB,SAApBA,iBAAoB,CAAU2G,KAAV,EAAiB;AACzC,MAAIhD,eAAJ;AACA,SAAO,YAAY;AACjB,WAAOA,WAAWA,SAAS,IAAIgD,KAAJ,CAAUC,SAAV,CAApB,CAAP;AACD,GAFD;AAGD,CALD;;AAOe5G,0EAAf,E;;;;;;AChBA,6C;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;;;;;;;;;;AAUA;AACA;AACA;;AAEA,IAAM6G,4BAA4B,SAA5BA,yBAA4B,CAACC,OAAD,EAAa;AAC7C;AACA,MAAIC,aAAaD,QAAQpF,KAAR,CAAc,GAAd,CAAjB;AACA,MAAIC,cAAcE,OAAOkF,WAAW,CAAX,CAAP,CAAlB;AACA,MAAIC,eAAeD,WAAW,CAAX,CAAnB;AACA,MAAIE,WAAWD,aAAatF,KAAb,CAAmB,GAAnB,CAAf;AACAC,gBAAcsF,SAAS,CAAT,IAAc,EAAd,GAAmB,EAAnB,GAAwB,IAAxB,GAA+BA,SAAS,CAAT,IAAc,EAAd,GAAmB,IAAlD,GAAyDA,SAAS,CAAT,IAAc,IAAvE,GAA8EtF,WAA5F;AACA,SAAOA,WAAP;AACD,CARD;;AAUA,IAAMyC,cAAc,SAAdA,WAAc,CAACZ,IAAD,EAAU;AAC5B,MAAI,CAACA,IAAL,EAAW;AACT,WAAO,EAAP;AACD;AACD,SAAOA,KAAKzC,OAAL,CAAa,UAAb,EAAyB,EAAzB,EAA6BA,OAA7B,CAAqC,WAArC,EAAkD,EAAlD,CAAP;AACD,CALD;;AAOA,IAAM0C,uBAAuB,SAAvBA,oBAAuB,CAACD,IAAD,EAAU;AACrC,MAAI0D,YAAY1D,KAAK9B,KAAL,CAAW,IAAX,CAAhB;AACA,MAAI;AACF;AACA,QAAIyF,SAAS,CAAb;AACA,QAAIC,YAAY,EAAhB;AACA,SAAK,IAAIvG,IAAI,CAAb,EAAgBA,IAAIqG,UAAU7F,MAA9B,EAAsCR,GAAtC,EAA2C;AACzC;AACA,UAAIA,MAAMsG,MAAV,EAAkB;AAChB;AACA,YAAIE,UAAU,CAAC,cAAD,EAAiB,cAAjB,CAAd;AACA,YAAKxG,IAAI,CAAL,IAAWqG,UAAU7F,MAAzB,EAAiC;AAC/B,iBAAO+F,SAAP;AACD;;AAED,YAAIN,UAAUI,UAAUrG,IAAI,CAAd,CAAd;AACA,YAAIiG,YAAY,EAAhB,EAAoB;AAClBO,oBAAUP,QAAQQ,IAAR,GAAe5F,KAAf,CAAqB,KAArB,EAA4BgF,MAA5B,CAAmC,UAACpB,IAAD,EAAU;AACrD,mBAAO,mCAAkCjF,IAAlC,CAAuCiF,IAAvC;AAAP;AACD,WAFS,CAAV;AAGD;;AAED,YAAI9F,OAAO;AACT0F,eAAKxC,8DAAOA,EADH;AAETkB,cAAIsD,UAAUrG,CAAV,EAAayG,IAAb,EAFK,EAEgB;AACzBzD,mCAAyBgD,0BAA0BQ,QAAQ,CAAR,CAA1B,CAHhB,EAGuD;AAChEvD,iCAAuB+C,0BAA0BQ,QAAQ,CAAR,CAA1B,CAJd,EAIqD;AAC9DrD,iBAAO,EALE,CAKC;AALD,SAAX;;AAQA;AACA,YAAIuD,MAAM/H,KAAKoE,EAAX,KAAkB2D,MAAM/H,KAAKqE,uBAAX,CAAlB,IAAyD0D,MAAM/H,KAAKsE,qBAAX,CAA7D,EAAgG;AAC9F,gBAAM,IAAI0D,KAAJ,CAAU,eAAV,CAAN;AACD;;AAED;AACA,YAAIC,oBAAoB,CAAxB;AACA,YAAK5G,IAAI4G,iBAAL,IAA2BP,UAAU7F,MAAzC,EAAiD;AAC/C7B,eAAKwE,KAAL,CAAWgB,IAAX,CAAgB,EAAhB;AACAoC,oBAAUpC,IAAV,CAAexF,IAAf;AACA,iBAAO4H,SAAP;AACD;;AAED;AACA;AACA,eAAOF,UAAUrG,IAAI4G,iBAAd,EAAiCH,IAAjC,OAA4C,EAAnD,EAAuD;AACrD9H,eAAKwE,KAAL,CAAWgB,IAAX,CAAgBZ,YAAY8C,UAAUrG,IAAI4G,iBAAd,CAAZ,CAAhB;AACAA;AACA,cAAK5G,IAAI4G,iBAAL,IAA2BP,UAAU7F,MAAzC,EAAiD;AAC/C7B,iBAAKwE,KAAL,CAAWgB,IAAX,CAAgB,EAAhB;AACAoC,sBAAUpC,IAAV,CAAexF,IAAf;AACA,mBAAO4H,SAAP;AACD;AACF;;AAED;AACA;AACA,YAAIM,mBAAmB7G,IAAI4G,iBAAJ,GAAwB,CAA/C;AACA,YAAIC,oBAAoBR,UAAU7F,MAAlC,EAA0C;AACxC8F,mBAAS,CAAT;AACAC,oBAAUpC,IAAV,CAAexF,IAAf;AACA,iBAAO4H,SAAP;AACD;;AAED;AACA,eAAOF,UAAUQ,gBAAV,EAA4BJ,IAA5B,OAAuC,EAA9C,EAAkD;AAChDI;AACA,cAAIA,oBAAoBR,UAAU7F,MAAlC,EAA0C;AACxC8F,qBAAS,CAAT;AACAC,sBAAUpC,IAAV,CAAexF,IAAf;AACA,mBAAO4H,SAAP;AACD;AACF;;AAED;AACAD,iBAASO,gBAAT;AACA7G,YAAI6G,mBAAmB,CAAvB;AACAN,kBAAUpC,IAAV,CAAexF,IAAf;AACD;AACF;;AAED4H,cAAUO,UAAV,GAAuBnE,IAAvB;;AAEA,WAAO4D,SAAP;AACD,GAlFD,CAkFE,OAAOQ,CAAP,EAAU;AACVtH,YAAQR,KAAR,CAAc,sBAAd,EAAsC,mBAAtC,EAA2D8H,EAAEC,QAAF,EAA3D;AACA,WAAO,EAAP;AACD;AACF,CAxFD;;AA0FA,IAAMxE;AAAA,iLAA4B,iBAAOH,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAC5B4E,qBAD4B,GAChBC,4DAASA,CAACC,iBAAV,CAA4B,cAA5B,EAA4C,CAA5C,CADgB;AAE5BC,qBAF4B,GAEhBH,UAAUI,OAAV,CAAkBhF,GAAlB,CAFgB;;AAAA,iBAI5B+E,SAJ4B;AAAA;AAAA;AAAA;;AAAA,6CAKvBA,SALuB;;AAAA;AAAA;AAAA,mBAQbE,sEAASA,CAACjF,GAAV,EAAekF,IAAf,CAAoB,UAACC,IAAD,EAAU;AAC/C,qBAAO,IAAI,sEAAQ,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAIC,SAAS,IAAIC,UAAJ,EAAb;AACAD,uBAAOE,MAAP,GAAgB,UAAUd,CAAV,EAAa;AAC3B,sBAAIpE,OAAOgF,OAAO7E,MAAlB;AACA,sBAAIsE,YAAYxE,qBAAqBD,IAArB,CAAhB;AACA,sBAAIsE,YAAYC,4DAASA,CAACC,iBAAV,CAA4B,cAA5B,EAA4C,CAA5C,CAAhB;AACAF,4BAAUa,GAAV,CAAczF,GAAd,EAAmB+E,SAAnB;AACAK,0BAAQL,SAAR;AACD,iBAND;AAOAO,uBAAOI,UAAP,CAAkBP,IAAlB,EAAwB,OAAxB;AACD,eAVM,CAAP;AAWD,aAZkB,CARa;;AAAA;AAQ5B1E,kBAR4B;AAAA,6CAqBzBA,MArByB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA5B;;AAAA;AAAA;AAAA;AAAA,GAAN;;;;;;;;ACzHA,0D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;;;;;;;;AAQA;AACA;AACA;AACA;;AAGA,SAASkF,SAAT,CAAoBC,IAApB,EAA0B;AACxB,MAAIC,OAAOD,KAAKC,IAAhB;AACA,MAAIC,UAAUF,KAAKG,GAAL,IAAY,OAA1B;;AAEA,MAAIC,qFAAcA,CAACH,IAAf,CAAJ,EAA0B;AACxB,WAAOD,IAAP;AACD,GAFD,MAEO;AACL,QAAM9F,SAASjD,yEAASA,CAAC,WAAV,CAAf;AACAiD,WAAOlD,KAAP,CAAa,WAAb,EAA0B,gBAA1B,EAA4CiJ,IAA5C,EAAkD,aAAlD,EAAiEC,OAAjE;AACD;AACF;;AAED,SAASG,YAAT,CAAuB9J,OAAvB,EAAgC;AAC9B;AAAA,mLAAO,iBAAgB6D,GAAhB,EAAqBkG,OAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,uBADD,GACa5J,KAAK6J,GAAL,MAAcC,WAAd,IAA6BA,YAAYD,GAAZ,EAD1C;AAAA;AAAA,qBAEcE,QAAQtG,GAAR,EAAakG,OAAb,EAAsBhB,IAAtB,CAA2B,oBAAY;AACxD,oBAAMqB,UAAUhK,KAAK6J,GAAL,MAAcC,WAAd,IAA6BA,YAAYD,GAAZ,EAA7C;AACAI,yBAASC,MAAT,GAAkBF,UAAUJ,SAA5B;AACA,oBAAMrG,SAASjD,yEAASA,CAAC,WAAV,CAAf;AACAiD,uBAAO4G,KAAP,CAAa,cAAb,EAA6BF,QAA7B;AACA,oBAAIrK,OAAJ,EAAa;AACX,yBAAOA,QAAQqK,QAAR,CAAP;AACD;;AAED,uBAAOA,QAAP;AACD,eAVkB,CAFd;;AAAA;AAED/F,oBAFC;AAAA,+CAaEA,MAbF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAeD;;AAED,IAAM6F;AAAA,kLAAU,kBAAwBtG,GAAxB;AAAA,QAA6BkG,OAA7B,uEAAuC,EAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AACdA,sBAAUS,oDAAKA,CAAC;AACdtK,sBAAQ,KADM;AAEduK,oBAAM,MAFQ;AAGdC,uBAAS,IAAIC,OAAJ;AAHK,aAAN,EAIPZ,OAJO,CAAV;;AAMA,gBAAIA,QAAQ7J,MAAR,CAAe0K,WAAf,OAAiC,KAArC,EAA4C;AAC1C,kBAAIb,QAAQ5J,IAAR,IAAgB,IAApB,EAA0B;AACxB0D,sBAAMA,MAAM,GAAN,GAAYgH,oDAAWA,CAACC,SAAZ,CAAsBf,QAAQ5J,IAA9B,CAAlB;AACD;AACF,aAJD,MAIO,IAAI4J,QAAQ7J,MAAR,CAAe0K,WAAf,OAAiC,MAArC,EAA6C;AAC9CF,qBAD8C,GACpCX,QAAQW,OAD4B;;;AAGlD,kBAAIX,QAAQgB,IAAR,IAAgBhB,QAAQgB,IAAR,CAAaH,WAAb,OAA+B,MAAnD,EAA2D;AACzDF,wBAAQM,GAAR,CAAY,cAAZ,EAA4B,iCAA5B;AACA,oBAAIjB,QAAQ5J,IAAR,IAAgB,IAApB,EAA0B;AACxB4J,0BAAQkB,IAAR,GAAe,6EAAelB,QAAQ5J,IAAvB,CAAf;AACD;AACF,eALD,MAKO,IAAI4J,QAAQgB,IAAR,IAAgBhB,QAAQgB,IAAR,CAAaH,WAAb,OAA+B,MAAnD,EAA2D;AAChEF,wBAAQM,GAAR,CAAY,cAAZ,EAA4B,kDAA5B;AACA,oBAAIjB,QAAQ5J,IAAR,IAAgB,IAApB,EAA0B;AACxB4J,0BAAQkB,IAAR,GAAeJ,oDAAWA,CAACC,SAAZ,CAAsBf,QAAQ5J,IAA9B,CAAf;AACD;AACF;AACF;;AAzBa,8CA2BP+K,MAAMrH,GAAN,EAAWkG,OAAX,CA3BO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAV;;AAAA,WAAyBI,OAAzB;AAAA;AAAA;;AAAA,SAAyBA,OAAzB;AAAA,GAAN;;AA+BA,IAAMgB;AAAA,kLAAM,kBAAoBtH,GAApB,EAAyBkG,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,8CACHD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,QAAP;AACD,aAFM,EAEJxG,GAFI,EAEC,4EAAckG,OAAd,EAAuB;AAC7B7J,sBAAQ;AADqB,aAAvB,CAFD,CADG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAN;;AAAA,WAAqBiL,GAArB;AAAA;AAAA;;AAAA,SAAqBA,GAArB;AAAA,GAAN;;AAQA,IAAMC;AAAA,kLAAO,kBAAqBvH,GAArB,EAA0BkG,OAA1B;AAAA;AAAA;AAAA;AAAA;AAAA,8CACJD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,QAAP;AACD,aAFM,EAEJxG,GAFI,EAEC,4EAAckG,OAAd,EAAuB;AAC7B7J,sBAAQ;AADqB,aAAvB,CAFD,CADI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;;AAAA,WAAsBkL,IAAtB;AAAA;AAAA;;AAAA,SAAsBA,IAAtB;AAAA,GAAN;;AAQA,IAAMtC;AAAA,kLAAY,kBAA0BjF,GAA1B,EAA+BkG,OAA/B;AAAA;AAAA;AAAA;AAAA;AAAA,8CACTD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,SAASrB,IAAT,EAAP;AACD,aAFM,EAEJnF,GAFI,EAECkG,OAFD,CADS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAZ;;AAAA,WAA2BjB,SAA3B;AAAA;AAAA;;AAAA,SAA2BA,SAA3B;AAAA,GAAN;;AAMA,IAAMuC;AAAA,kLAAY,kBAA0BxH,GAA1B,EAA+BkG,OAA/B;AAAA;AAAA;AAAA;AAAA;AAAA,8CACTD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,SAASlG,IAAT,EAAP;AACD,aAFM,EAEJN,GAFI,EAECkG,OAFD,CADS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAZ;;AAAA,WAA2BsB,SAA3B;AAAA;AAAA;;AAAA,SAA2BA,SAA3B;AAAA,GAAN;;AAMA,IAAMC;AAAA,kLAAY,kBAA0BzH,GAA1B,EAA+BkG,OAA/B;AAAA;AAAA;AAAA;AAAA;AAAA,8CACTD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,SAASZ,IAAT,GAAgBV,IAAhB,CAAqB;AAAA,uBAAQS,UAAUC,IAAV,CAAR;AAAA,eAArB,CAAP;AACD,aAFM,EAEJ5F,GAFI,EAECkG,OAFD,CADS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAZ;;AAAA,WAA2BuB,SAA3B;AAAA;AAAA;;AAAA,SAA2BA,SAA3B;AAAA,GAAN;;AAMA,IAAMC;AAAA,kLAAmB,kBAAiC1H,GAAjC,EAAsCkG,OAAtC;AAAA;AAAA;AAAA;AAAA;AAAA,8CAChBD,aAAa,UAACO,QAAD,EAAc;AAChC,qBAAOA,SAASmB,WAAT,EAAP;AACD,aAFM,EAEJ3H,GAFI,EAECkG,OAFD,CADgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAnB;;AAAA,WAAkCwB,gBAAlC;AAAA;AAAA;;AAAA,SAAkCA,gBAAlC;AAAA,GAAN;;;;;;;;AC7GA,gE;;;;;;ACAA,iE;;;;;;;;;;;;;;;;;;;ACAA;;;;;;;;AAQA;AACA;;AAEA;;;;;AAKA,IAAM1B,iBAAiB,SAAjBA,cAAiB,GAAe;AAAA,MAAd1J,IAAc,uEAAP,EAAO;;AACpC,MAAMuJ,OAAO,OAAOvJ,IAAP,KAAgB,QAAhB,GAA2BA,IAA3B,GAAkCA,KAAKuJ,IAApD;AACA,SAAOA,QAAQ,IAAR,GAAeA,SAASzF,qEAASA,CAACwH,YAAlC,GAAiD,IAAxD;AACD,CAHD;;AAKA,IAAMC,UAAU,SAAVA,OAAU,CAACC,IAAD,EAAOC,WAAP,EAAuB;AACrC,MAAIC,SAASD,eAAeE,OAAOC,MAAtB,IAAgC,EAA7C;AACA,MAAIC,QAAQH,OAAO,WAAP,KAAuB,EAAnC;AACA,SAAOG,MAAMC,QAAN,CAAeN,IAAf,CAAP;AACD,CAJD;;AAMA;;;AAGA,IAAMO,4BAA4B,SAA5BA,yBAA4B,CAACC,QAAD,EAAWC,aAAX,EAA0BC,cAA1B,EAA0CxK,KAA1C,EAAiDyK,WAAjD,EAAiE;AAAA;AAAA;AAAA;;AAAA;AACjG,oGAAgBH,QAAhB,4GAA0B;AAAA,UAAjBI,GAAiB;;AACxBA,UAAIH,aAAJ,IAAqBC,cAArB;AACD;AAHgG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIjG,MAAIxK,UAAU2K,SAAV,IAAuBF,gBAAgBE,SAA3C,EAAsD;AACpDL,aAAStK,KAAT,EAAgBuK,aAAhB,IAAiCE,WAAjC;AACD;AACF,CAPD;;AASA;;;AAGA,IAAMG,6BAA6B,SAA7BA,0BAA6B,CAACN,QAAD,EAAWC,aAAX,EAA0BC,cAA1B,EAA6C;AAC9E,MAAI5K,MAAM0K,SAASnK,MAAnB;AACA,MAAIsC,SAAS,EAAb;AACA,OAAK,IAAI9C,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,QAAI+K,MAAMJ,SAAS3K,CAAT,CAAV;AACA,QAAI+K,IAAIH,aAAJ,MAAuBC,cAA3B,EAA2C;AACzC/H,aAAOqB,IAAP,CAAYnE,CAAZ;AACD;AACF;AACD,SAAO8C,MAAP;AACD,CAVD;;AAYA,IAAMoI,eAAe,SAAfA,YAAe,GAAM;AACzB,MAAIC,UAAUC,SAAV,CAAoBjG,OAApB,CAA4B,MAA5B,IAAsC,CAA1C,EAA6C;AAC3C,QAAIgG,UAAUC,SAAV,CAAoBjG,OAApB,CAA4B,UAA5B,IAA0C,CAA9C,EAAiD;AAC/CmF,aAAOe,MAAP,GAAgB,IAAhB;AACAf,aAAOgB,KAAP;AACD,KAHD,MAGO;AACLhB,aAAOiB,IAAP,CAAY,EAAZ,EAAgB,MAAhB;AACAjB,aAAOkB,GAAP,CAAWF,KAAX;AACD;AACF,GARD,MAQO,IAAIH,UAAUC,SAAV,CAAoBjG,OAApB,CAA4B,SAA5B,IAAyC,CAAzC,IAA8CgG,UAAUC,SAAV,CAAoBjG,OAApB,CAA4B,QAA5B,IAAwC,CAA1F,EAA6F;AAClGmF,WAAOmB,QAAP,CAAgBC,IAAhB,GAAuB,aAAvB;AACApB,WAAOgB,KAAP;AACD,GAHM,MAGA;AACLhB,WAAOe,MAAP,GAAgB,IAAhB;AACAf,WAAOiB,IAAP,CAAY,EAAZ,EAAgB,OAAhB;AACAjB,WAAOgB,KAAP;AACD;AACF,CAjBD;AAkBA;;;AAGA,IAAMK,iBAAiB,SAAjBA,cAAiB,CAACpK,CAAD,EAAIqK,GAAJ,EAASC,GAAT,EAAiB;AACtC,MAAIlG,IAAI,EAAR;;AAEA,MAAIiG,MAAMC,GAAV,EAAe;AACb,WAAO,CAAC,CAAD,CAAP;AACD;;AAED,OAAK,IAAI7L,IAAI,CAAb,EAAgBA,IAAIuB,CAApB,EAAuBvB,GAAvB,EAA4B;AAC1B2F,MAAExB,IAAF,CAAOvE,KAAKC,KAAL,CAAWD,KAAKkM,MAAL,MAAiBD,MAAMD,GAAN,GAAY,CAA7B,CAAX,IAA8CA,GAArD;AACD;;AAEDjG,IAAED,IAAF,CAAO,YAAM;AACX,WAAO,MAAM9F,KAAKkM,MAAL,EAAb;AACD,GAFD;;AAIA,SAAOnG,CAAP;AACD,CAhBD;;;;;;;;AC3EA,yC;;;;;;ACAA,yC;;;;;;;;;;;;;;;;;ACAA;;;;;;;;;AASA;;AAEA,IAAMoG,YAAY,IAAI,mEAAtB;;IACM7E,S;AACJ,qBAAa5I,IAAb,EAAmB0N,QAAnB,EAA6B;AAAA;;AAC3B,SAAK7J,MAAL,GAAcjD,yEAASA,CAAC,WAAV,CAAd;AACA,SAAKZ,IAAL,GAAYA,QAAQ,SAApB;AACA,QAAIyN,UAAUE,GAAV,CAAc3N,IAAd,CAAJ,EAAyB;AACvB,WAAK6D,MAAL,CAAYlD,KAAZ,CAAkB,mBAAlB,EAAuC,sBAAvC,EAA+DX,IAA/D,EAAqE,0BAArE;AACA;AACD;AACD,SAAK4N,cAAL,GAAsB,EAAtB;AACA,SAAKC,cAAL,GAAsBH,YAAY,EAAlC;AACAD,cAAUvC,GAAV,CAAc,KAAKlL,IAAnB,EAAyB,IAAzB;AACD;;;;wBASI8N,G,EAAKzN,I,EAAM;AACd,UAAI0N,QAAQ,KAAKH,cAAjB;AACA,aAAOG,MAAM7L,MAAN,IAAgB,KAAK2L,cAA5B,EAA4C;AAC1CE,cAAMC,KAAN;AACD;AACDD,YAAMlI,IAAN,CAAW,IAAI,kEAAI,CAAC,CAACiI,GAAD,EAAMzN,IAAN,CAAD,CAAR,CAAX;AACD;;;4BAEQ;AACP,WAAKuN,cAAL,CAAoB1L,MAApB,GAA6B,CAA7B;AACD;;;iCAEa4L,G,EAAK;AACjB,UAAIG,UAAU,KAAKL,cAAL,CAAoBpH,IAApB,CAAyB,UAACpB,GAAD,EAAS;AAC9C,eAAOA,IAAIuI,GAAJ,CAAQG,GAAR,CAAP;AACD,OAFa,CAAd;AAGA,UAAIzN,OAAO4N,WAAWA,QAAQC,GAAR,CAAYJ,GAAZ,CAAtB;AACA,UAAIzN,IAAJ,EAAU;AACR,aAAKwD,MAAL,CAAYiD,IAAZ,CAAiB,kBAAjB,EAAqC,oCAArC,EAA2EgH,GAA3E;AACD,OAFD,MAEO;AACL,aAAKjK,MAAL,CAAYiD,IAAZ,CAAiB,kBAAjB,EAAqC,sCAArC,EAA6EgH,GAA7E;AACD;AACD,aAAOzN,IAAP;AACD;;;4BAEQyN,G,EAAK;AACZ,aAAO,KAAKK,YAAL,CAAkBL,GAAlB,CAAP;AACD;;;oCAEgBA,G,EAAK;AACpB,UAAI/L,QAAQ,KAAK6L,cAAL,CAAoB1H,SAApB,CAA8B,UAAC+H,OAAD,EAAa;AACrDA,gBAAQN,GAAR,CAAYG,GAAZ;AACD,OAFW,CAAZ;AAGA,UAAI/L,QAAQ,CAAC,CAAb,EAAgB;AACd,aAAK6L,cAAL,CAAoBxH,MAApB,CAA2BrE,KAA3B,EAAkC,CAAlC;AACD,OAFD,MAEO;AACL,aAAK8B,MAAL,CAAYnD,IAAZ,CAAiB,+BAAjB,EAAkD,eAAlD,EAAmEoN,GAAnE,EAAwE,YAAxE;AACD;AACF;;;sCA7CyB9N,I,EAAM0N,Q,EAAU;AACxC,UAAID,UAAUE,GAAV,CAAc3N,IAAd,CAAJ,EAAyB;AACvB,eAAOyN,UAAUS,GAAV,CAAclO,IAAd,CAAP;AACD;AACD,aAAO,IAAI4I,SAAJ,CAAc5I,IAAd,EAAoB0N,QAApB,CAAP;AACD;;;;;;AA0CY9E,kEAAf,E;;;;;;ACxEA,sD","file":"srt-engine.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"srt-engine\"] = factory();\n\telse\n\t\troot[\"srt-engine\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 33400983b5aa532c9129","module.exports = require(\"babel-runtime/helpers/classCallCheck\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/classCallCheck\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/createClass\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/createClass\"\n// module id = 1\n// module chunks = 0","/*\r\n * Created Date: 2018-03-01 11:14:20\r\n * Author: yinzhida Email: yinzhida@qiyi.com\r\n * -----\r\n * Last Modified: 2019-10-30 16:24:24\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nimport getClassSingleton from './single';\r\n\r\nclass Logger {\r\n  constructor (component) {\r\n    this.name = component;\r\n    this.debug = process.env.NODE_ENV !== 'production';\r\n  }\r\n\r\n  log (...args) {\r\n    if (this.debug) {\r\n      console.log(...args);\r\n    }\r\n  }\r\n\r\n  trans (method, ...data) {\r\n    this.log(`%c[Data Transmission][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > data: `, 'color: blue;', ...data);\r\n  }\r\n\r\n  info (method, ...information) {\r\n    this.log(`%c[Info][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > information: `, 'color: green;', ...information);\r\n  }\r\n\r\n  warn (method, ...warning) {\r\n    console.warn(`[Warning][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > warning: `, ...warning);\r\n  }\r\n\r\n  error (method, ...error) {\r\n    console.error(`[Error][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > error: `, ...error);\r\n  }\r\n}\r\n\r\nconst getLogger = getClassSingleton(Logger);\r\n\r\nexport default getLogger;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/logger.js","module.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/get-iterator\"\n// module id = 3\n// module chunks = 0","/**\r\n * @Desc:   时间处理工具\r\n * @Author: yinzhida\r\n * @Email:  yinzhida@qiyi.com\r\n * @Date:   2018-02-27 15:42:44\r\n * @Last Modified by:   yinzhida\r\n * @Last Modified time: 2018-02-28 15:21:33\r\n */\r\n\r\n/**\r\n * 根据时间格式，将数字格式的时间转换为格式字符串\r\n * @param  {[type]} secondtime   [description]\r\n * @param  {[type]} formatString [description]\r\n * @return {[type]}              [description]\r\n */\r\nconst formatTime = (secondtime, formatString, frameRate) => {\r\n  formatString = formatString || 'hh:mm:ss S';\r\n\r\n  if (/SS+|FF+/.test(formatString)) {\r\n    console.error('formatTime', '毫秒格式错误，不能有多个连续的S或F出现');\r\n    return;\r\n  }\r\n\r\n  let timeKey = [{\r\n    name: 'hour',\r\n    regString: 'h+'\r\n  }, {\r\n    name: 'minute',\r\n    regString: 'm+'\r\n  }, {\r\n    name: 'second',\r\n    regString: 's+'\r\n  }];\r\n\r\n  if (!/S|F/.test(formatString)) {\r\n    secondtime = Math.floor(secondtime);\r\n  }\r\n\r\n  let timeNumbers = getTimeNumbers(secondtime, frameRate);\r\n\r\n  for (let i = 0, len = timeKey.length; i < len; i++) {\r\n    formatString = formatString.replace(new RegExp(timeKey[i].regString), function (matchString, index, originalString) {\r\n      return formatNumber(timeNumbers[timeKey[i].name], matchString.length);\r\n    });\r\n  }\r\n\r\n  // 毫秒只支持3位模式\r\n  formatString = formatString.replace(/S/, formatNumber(timeNumbers.milli, 3));\r\n  formatString = formatString.replace(/F/, formatNumber(timeNumbers.frame));\r\n  return formatString;\r\n};\r\n\r\n/**\r\n * 根据时间number获取小时，分钟，秒，毫秒数\r\n * @param  {[type]} secondtime [description]\r\n * @return {[type]}            [description]\r\n */\r\nconst getTimeNumbers = (secondtime, frameRate = 25) => {\r\n  // 转成字符串\r\n  secondtime = secondtime.toFixed(3);\r\n  // 从小数点切分\r\n  let timeArray = secondtime.split('.');\r\n  // 小数点后三位是毫秒部分\r\n  let milliSecond = 0;\r\n  let frame = 0;\r\n  if (timeArray[1]) {\r\n    milliSecond = Math.round(Number('0.' + timeArray[1]) * 1000);\r\n    frame = Math.floor(milliSecond / (1000 / frameRate));\r\n  }\r\n  // 分别获取时分秒\r\n  let hour = 0;\r\n  let minute = 0;\r\n  let second = 0;\r\n  // 一共多少秒\r\n  let totalSeconds = Number(timeArray[0]);\r\n  // 几个小时\r\n  hour = Math.floor(totalSeconds / 3600);\r\n  // 剩余秒数\r\n  let firstRemain = totalSeconds % 3600;\r\n  // 几分钟\r\n  minute = Math.floor(firstRemain / 60);\r\n  // 剩余秒数\r\n  second = firstRemain % 60;\r\n\r\n  let timeNumbers = {\r\n    hour: hour,\r\n    minute: minute,\r\n    second: second,\r\n    milli: milliSecond,\r\n    frame: frame\r\n  };\r\n\r\n  return timeNumbers;\r\n};\r\n\r\n/**\r\n * 数字格式化,在数字前边加0，补全到几位，比如输入1,3，则输出001\r\n * @param  {[type]} number [description]\r\n * @param  {[type]} n      [description]\r\n * @return {[type]}        [description]\r\n */\r\nconst formatNumber = (number, n) => {\r\n  n = n || 2;\r\n  number = number + '';\r\n  let numberArray = number.split('');\r\n\r\n  if (numberArray.length < n) {\r\n    let len = n - numberArray.length;\r\n    for (let i = 0; i < len; i++) {\r\n      numberArray.unshift('0');\r\n    }\r\n  }\r\n\r\n  let res = numberArray.join('');\r\n  return res;\r\n};\r\n\r\nexport {\r\n  formatTime,\r\n  getTimeNumbers,\r\n  formatNumber\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/time.js","/**\r\n * @file guid.js\r\n * @module guid\r\n */\r\n\r\n/**\r\n * Unique ID for an element or function\r\n * @type {Number}\r\n */\r\nlet _guid = 1;\r\n\r\n/**\r\n * Get a unique auto-incrementing ID by number that has not been returned before.\r\n *\r\n * @return {number}\r\n *         A new unique ID.\r\n */\r\nconst newGUID = function newGUID () {\r\n  return _guid++;\r\n};\r\n\r\nexport default newGUID;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/guid.js","\r\n\r\nexport default {\r\n  WILL_BUILD_INDEX_COUNT: 60,\r\n  UID_INDEX_GROUP_SIZE: 50,\r\n  ITME_INDEX_GROUP_DURATION: 1000 * 60 * 10, // 10分钟\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/config/constants.js","module.exports = require(\"babel-runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/regenerator\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/asyncToGenerator\"\n// module id = 8\n// module chunks = 0","import SrtEngine from './clazz/srt-engine';\r\n\r\nexport {\r\n  SrtEngine,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/index.js","import getLogger from '@/js/utils/logger';\r\nimport { formatTime } from '@/js/utils/time';\r\nimport newGUID from '@/js/utils/guid';\r\nimport constants from '@/js/config/constants';\r\nimport cloneDeep from 'lodash.clonedeep';\r\nimport { getSubtitleTextArrayByUrl, getTextArrayFromText, getPureText } from '@/js/utils/srt';\r\n\r\nclass SrtEngine {\r\n  constructor (shouldBuildIndex) {\r\n    this.logger = getLogger('SrtEngine');\r\n    this.content = [];\r\n    this.url = null;\r\n    this.shouldBuildIndex = typeof shouldBuildIndex === 'boolean' ? shouldBuildIndex : true;\r\n    this.timeIndexGroup = null;\r\n    this.uidIndexGroup = null;\r\n  }\r\n\r\n  load (url) {\r\n    this.url = url;\r\n    this.content = getSubtitleTextArrayByUrl(url);\r\n    if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n      this.buildIndex();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  compile (text) {\r\n    this.url = '';\r\n    this.content = getTextArrayFromText(text);\r\n    if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n      this.buildIndex();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  stringify (styles) {\r\n    let result = '';\r\n    let len = this.content.length;\r\n    for (let i = 0; i < len; i++) {\r\n      let data = this.content[i];\r\n      let id = i + 1;\r\n      result += id + '\\n';\r\n      result += formatTime((data.startTimeInMilliSeconds / 1000), 'hh:mm:ss,S');\r\n      result += ' --> ';\r\n      result += formatTime((data.endTimeInMilliSeconds / 1000), 'hh:mm:ss,S');\r\n      result += '\\n';\r\n      result += this.getStyledTexts(data.texts, styles).join('\\n') + '\\n\\n';\r\n    }\r\n    return result;\r\n  }\r\n\r\n  getStyledTexts (texts, styles) {\r\n    const supportStyles = [{\r\n      name: 'fontColor',\r\n      method (text, value) {\r\n        return `<font color=\"${value}\">${text}</font>`;\r\n      }\r\n    }, {\r\n      name: 'fontSize',\r\n      method (text, value) {\r\n        if (/<font\\s color=\"/.test(text)) {\r\n          text.replace('<font', `<font size=${value}`);\r\n        } else {\r\n          return `<font size=\"${value}\">${text}</font>`;\r\n        }\r\n      }\r\n    }, {\r\n      name: 'bold',\r\n      method (text, value) {\r\n        return `<b>${text}</b>`;\r\n      }\r\n    }, {\r\n      name: 'italic',\r\n      method (text, value) {\r\n        return `<i>${text}</i>`;\r\n      }\r\n    }, {\r\n      name: 'underground',\r\n      method (text, value) {\r\n        return `<u>${text}</u>`;\r\n      }\r\n    }, {\r\n      name: 'align',\r\n      method (text, value) {\r\n        return `{\\\\an${value}}${text}`;\r\n      }\r\n    }];\r\n\r\n    const serialize = (text) => {\r\n      text = getPureText(text);\r\n      for (let style of supportStyles) {\r\n        let styleValue = styles[style.name];\r\n        if (styleValue) {\r\n          text = style.method(text, styleValue);\r\n        }\r\n      }\r\n    };\r\n\r\n    texts.map(serialize);\r\n  }\r\n\r\n  buildIndex () {\r\n    const len = this.content.length;\r\n    this.timeIndexGroup = {};\r\n    this.uidIndexGroup = {};\r\n    for (let i = 0; i < len; i++) {\r\n      const data = this.content[i];\r\n      this._addToIndex(data);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  _addToIndex (data) {\r\n    this._addToTimeIndex(data);\r\n    this._addToUidIndex(data);\r\n  }\r\n\r\n  _removeFromIndex (data) {\r\n    this._removeFromTimeIndex(data);\r\n    this._removeFromUidIndex(data);\r\n  }\r\n\r\n  _addToTimeIndex (data) {\r\n    const levelKey = this.getTimeLevelKey(data.startTimeInMilliSeconds);\r\n    const endLevelKey = this.getTimeLevelKey(data.endTimeInMilliSeconds);\r\n    this.timeIndexGroup[levelKey] = this.timeIndexGroup[levelKey] || [];\r\n    this.timeIndexGroup[levelKey].push(data);\r\n    if (levelKey !== endLevelKey) {\r\n      this.timeIndexGroup[endLevelKey] = this.timeIndexGroup[endLevelKey] || [];\r\n      this.timeIndexGroup[endLevelKey].push(data);\r\n    }\r\n  }\r\n\r\n  _addToUidIndex (data) {\r\n    const levelKey = this.getUidLevelKey(data.uid);\r\n    this.timeIndexGroup[levelKey] = this.timeIndexGroup[levelKey] || [];\r\n    this.timeIndexGroup[levelKey].push(data);\r\n  }\r\n\r\n  _removeFromTimeIndex (data) {\r\n    const levelKey = this.getTimeLevelKey(data.startTimeInMilliSeconds);\r\n    const endLevelKey = this.getTimeLevelKey(data.endTimeInMilliSeconds);\r\n\r\n    let currentGroup = this.timeIndexGroup[levelKey];\r\n    let dataIndex = currentGroup.findIndex(item => item.uid === data.uid);\r\n    currentGroup.splice(dataIndex, 1);\r\n\r\n    if (levelKey !== endLevelKey) {\r\n      let currentEndGroup = this.timeIndexGroup[endLevelKey];\r\n      let endDataIndex = currentEndGroup.findIndex(item => item.uid === data.uid);\r\n      currentEndGroup.splice(endDataIndex, 1);\r\n    }\r\n  }\r\n\r\n  _removeFromUidIndex (data) {\r\n    let levelKey = this.getUidLevelKey(data.uid);\r\n    let currentGroup = this.uidIndexGroup[levelKey];\r\n    let dataIndex = currentGroup.findIndex(item => item.uid === data.uid);\r\n    currentGroup.splice(dataIndex, 1);\r\n  }\r\n\r\n  findByTime (milliSecondtime) {\r\n    if (this.timeIndexGroup) { // 通过索引查询\r\n      const levelKey = this.getTimeLevelKey(milliSecondtime);\r\n      return this.timeIndexGroup[levelKey].find((item) => {\r\n        return item.startTimeInMilliSeconds < milliSecondtime &&\r\n          item.endTimeInMilliSeconds > milliSecondtime &&\r\n          !item.deleted;\r\n      });\r\n    } else { // 直接轮询查询\r\n      let len = this.content.length;\r\n      for (let i = 0; i < len; i++) {\r\n        let data = this.content[i];\r\n        if (data.startTimeInMilliSeconds < milliSecondtime &&\r\n          data.endTimeInMilliSeconds > milliSecondtime &&\r\n          !data.deleted) {\r\n          return data;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getTimeLevelKey (milliSecondtime) {\r\n    return parseInt(milliSecondtime / constants.ITME_INDEX_GROUP_DURATION);\r\n  }\r\n\r\n  getUidLevelKey (uid) {\r\n    return parseInt(uid / constants.UID_INDEX_GROUP_SIZE);\r\n  }\r\n\r\n  findByText (word) {\r\n    let searchResult = [];\r\n    let len = this.content.length;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      let data = this.content[i];\r\n      if (!data.deleted && data.texts.join('\\n').indexOf(word) !== -1) {\r\n        searchResult.push(data);\r\n      }\r\n    }\r\n\r\n    return searchResult;\r\n  }\r\n\r\n  findByUid (uid) {\r\n    if (this.timeIndexGroup) { // 通过索引查询\r\n      let levelKey = this.getUidLevelKey(uid);\r\n      return this.uidIndexGroup[levelKey].find((item) => {\r\n        return item.uid === uid && !item.deleted;\r\n      });\r\n    } else { // 直接轮询查询\r\n      let len = this.content.length;\r\n      for (let i = 0; i < len; i++) {\r\n        let data = this.content[i];\r\n        if (data.uid === uid && !data.deleted) {\r\n          return data;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  addDialogue ({ startTimeInMilliSeconds, endTimeInMilliSeconds, texts, index }) {\r\n    let data = {\r\n      uid: newGUID(),\r\n      id: null,\r\n      startTimeInMilliSeconds,\r\n      endTimeInMilliSeconds,\r\n      texts,\r\n    };\r\n    this.content.splice(index, 0, data);\r\n    if (this.shouldBuildIndex) {\r\n      if (this.timeIndexGroup !== null && this.uidIndexGroup !== null) {\r\n        this._addToIndex(data);\r\n      } else {\r\n        this.buildIndex();\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  updateDialogueByUid (uid, info) {\r\n    let data = this.findByUid(uid);\r\n    const originData = cloneDeep(data);\r\n    let needUpdateTimeIndex = false;\r\n\r\n    if (typeof info.startTimeInMilliSeconds === 'number') {\r\n      needUpdateTimeIndex = true;\r\n      data.startTimeInMilliSeconds = info.startTimeInMilliSeconds;\r\n    }\r\n\r\n    if (typeof info.endTimeInMilliSeconds === 'number') {\r\n      needUpdateTimeIndex = true;\r\n      data.endTimeInMilliSeconds = info.endTimeInMilliSeconds;\r\n    }\r\n\r\n    if (this.timeIndexGroup !== null && needUpdateTimeIndex) {\r\n      this._removeFromIndex(originData);\r\n      this._addToIndex(data);\r\n    }\r\n\r\n    data.texts = info.texts;\r\n  }\r\n\r\n  removeDialogueByUid (uid) {\r\n    let data = this.findByUid(uid);\r\n    data.deleted = true;\r\n  }\r\n\r\n  sort () {\r\n    this.content.sort((a, b) => {\r\n      return a.startTimeInMilliSeconds - b.startTimeInMilliSeconds;\r\n    });\r\n  }\r\n\r\n  getContent () {\r\n    return cloneDeep(this.content.filter(item => !item.deleted).map((item) => {\r\n      item.texts.map(getPureText);\r\n      return item;\r\n    }));\r\n  }\r\n}\r\n\r\nexport default SrtEngine;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/clazz/srt-engine.js","/*\r\n * Created Date: 2018-03-15 10:23:03\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2019-03-26 18:25:51\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nconst getClassSingleton = function (Clazz) {\r\n  let result;\r\n  return function () {\r\n    return result || (result = new Clazz(arguments));\r\n  };\r\n};\r\n\r\nexport default getClassSingleton;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/single.js","module.exports = require(\"lodash.clonedeep\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.clonedeep\"\n// module id = 12\n// module chunks = 0","/*\r\n * Created Date: 2018-04-18 5:34:06\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2019-10-31 16:16:53\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\n\r\nimport { fetchBlob } from '@/js/dao/dao';\r\nimport DataCache from './data-cache';\r\nimport newGUID from './guid';\r\n\r\nconst getMilliSecondsFromString = (timeStr) => {\r\n  // 时间格式转换\r\n  let timeDivide = timeStr.split(',');\r\n  let milliSecond = Number(timeDivide[1]);\r\n  let otherTimeStr = timeDivide[0];\r\n  let hmsArray = otherTimeStr.split(':');\r\n  milliSecond = hmsArray[0] * 60 * 60 * 1000 + hmsArray[1] * 60 * 1000 + hmsArray[2] * 1000 + milliSecond;\r\n  return milliSecond;\r\n};\r\n\r\nconst getPureText = (text) => {\r\n  if (!text) {\r\n    return '';\r\n  }\r\n  return text.replace(/{\\\\.*?}/g, '').replace(/<\\/?.*?>/g, '');\r\n};\r\n\r\nconst getTextArrayFromText = (text) => {\r\n  let lineArray = text.split('\\n');\r\n  try {\r\n    // 一条字幕的开始点\r\n    let marker = 0;\r\n    let dataArray = [];\r\n    for (let i = 0; i < lineArray.length; i++) {\r\n      // here is a start point of data\r\n      if (i === marker) {\r\n        // default timeString\r\n        let timeArr = ['00:00:00,000', '00:00:00,000'];\r\n        if ((i + 1) >= lineArray.length) {\r\n          return dataArray;\r\n        }\r\n\r\n        let timeStr = lineArray[i + 1];\r\n        if (timeStr !== '') {\r\n          timeArr = timeStr.trim().split(/\\s+/).filter((item) => {\r\n            return /\\d{1,2}:\\d{1,2}:\\d{1,2},\\d{1,3}/.test(item);\r\n          });\r\n        }\r\n\r\n        let data = {\r\n          uid: newGUID(),\r\n          id: lineArray[i].trim(), // id\r\n          startTimeInMilliSeconds: getMilliSecondsFromString(timeArr[0]), // 根据字幕里的事件字符串，获取开始结束的以毫秒计数的时间点\r\n          endTimeInMilliSeconds: getMilliSecondsFromString(timeArr[1]), // 根据字幕里的事件字符串，获取开始结束的以毫秒计数的时间点\r\n          texts: [] // subtitle content,may have several lines\r\n        };\r\n\r\n        // 如果这些数据有误，说明这个字幕文件格式不太对。\r\n        if (isNaN(data.id) || isNaN(data.startTimeInMilliSeconds) || isNaN(data.endTimeInMilliSeconds)) {\r\n          throw new Error('字幕文件的内容，格式有误！');\r\n        }\r\n\r\n        // now point to the content line i+2，就是说id和时间后边，是这个字幕的内容，这部分是从第三行开始\r\n        let contentLineNumber = 2;\r\n        if ((i + contentLineNumber) >= lineArray.length) {\r\n          data.texts.push('');\r\n          dataArray.push(data);\r\n          return dataArray;\r\n        }\r\n\r\n        // 当然这个字幕到底是有一行字幕还是有两行或者三行字幕都不好说，所以做一下循环，看看到底有几行\r\n        // if line i+2 have words, then it must be the subtitle contentline. and we should find it's next line, util we get a '', another case is there is'nt content line.\r\n        while (lineArray[i + contentLineNumber].trim() !== '') {\r\n          data.texts.push(getPureText(lineArray[i + contentLineNumber]));\r\n          contentLineNumber++;\r\n          if ((i + contentLineNumber) >= lineArray.length) {\r\n            data.texts.push('');\r\n            dataArray.push(data);\r\n            return dataArray;\r\n          }\r\n        }\r\n\r\n        // 查找完字幕内容，就该来分析一下，这句字幕是不是结束啦，后边空行是不是有多于一行，然后计算出下一句字幕的开始位置（marker）。\r\n        // now we know at the index 'i+contentLineNumber' we get a '', so we should see the next line 'i+contentLineNumber+1' until we get some words.\r\n        let divideLineNumber = i + contentLineNumber + 1;\r\n        if (divideLineNumber >= lineArray.length) {\r\n          marker = 0;\r\n          dataArray.push(data);\r\n          return dataArray;\r\n        }\r\n\r\n        // 这个地方空行可能也不止一行，不过按理说应该是一行才对。\r\n        while (lineArray[divideLineNumber].trim() === '') {\r\n          divideLineNumber++;\r\n          if (divideLineNumber >= lineArray.length) {\r\n            marker = 0;\r\n            dataArray.push(data);\r\n            return dataArray;\r\n          }\r\n        }\r\n\r\n        // here we got a new marker point.\r\n        marker = divideLineNumber;\r\n        i = divideLineNumber - 1;\r\n        dataArray.push(data);\r\n      }\r\n    }\r\n\r\n    dataArray.originText = text;\r\n\r\n    return dataArray;\r\n  } catch (e) {\r\n    console.error('getTextArrayFromText', '解析文件出错，文件格式可能不正确。', e.toString());\r\n    return [];\r\n  }\r\n};\r\n\r\nconst getSubtitleTextArrayByUrl = async (url) => {\r\n  let cacheUtil = DataCache.getInstanceByname('subtitleText', 2);\r\n  let textArray = cacheUtil.getData(url);\r\n\r\n  if (textArray) {\r\n    return textArray;\r\n  }\r\n\r\n  let result = await fetchBlob(url).then((blob) => {\r\n    return new Promise((resolve, reject) => {\r\n      let reader = new FileReader();\r\n      reader.onload = function (e) {\r\n        let text = reader.result;\r\n        let textArray = getTextArrayFromText(text);\r\n        let cacheUtil = DataCache.getInstanceByname('subtitleText', 2);\r\n        cacheUtil.add(url, textArray);\r\n        resolve(textArray);\r\n      };\r\n      reader.readAsText(blob, 'UTF-8');\r\n    });\r\n  });\r\n  return result;\r\n};\r\n\r\nexport {\r\n  getMilliSecondsFromString,\r\n  getPureText,\r\n  getTextArrayFromText,\r\n  getSubtitleTextArrayByUrl,\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/srt.js","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/promise\"\n// module id = 14\n// module chunks = 0","/**\n * @Desc:   Http Utils in video-editor\n * @Author: yinzhida\n * @Email:  yinzhida@qiyi.com\n * @Date:   2018-02-09 17:59:45\n * @Last Modified by:   yinzhida\n * @Last Modified time: 2018-02-28 15:05:14\n */\nimport { isFetchSuccess } from '@/js/utils/common-util';\nimport getLogger from '@/js/utils/logger';\nimport queryString from 'query-string';\nimport merge from 'lodash.merge';\n\n\nfunction checkCode (json) {\n  let code = json.code;\n  let message = json.msg || 'error';\n\n  if (isFetchSuccess(code)) {\n    return json;\n  } else {\n    const logger = getLogger('SrtEngine');\n    logger.error('checkCode', 'Server error: ', code, ', message: ', message);\n  }\n}\n\nfunction fetchFactory (process) {\n  return async function (url, options) {\n    const startTime = Date.now() && performance && performance.now();\n    let result = await request(url, options).then(response => {\n      const endTime = Date.now() && performance && performance.now();\n      response.timing = endTime - startTime;\n      const logger = getLogger('SrtEngine');\n      logger.trans('fetchFactory', response);\n      if (process) {\n        return process(response);\n      }\n\n      return response;\n    });\n    return result;\n  };\n}\n\nconst request = async function request (url, options = {}) {\n  options = merge({\n    method: 'GET',\n    mode: 'cors',\n    headers: new Headers()\n  }, options);\n\n  if (options.method.toUpperCase() === 'GET') {\n    if (options.data != null) {\n      url = url + '?' + queryString.stringify(options.data);\n    }\n  } else if (options.method.toUpperCase() === 'POST') {\n    let headers = options.headers;\n\n    if (options.type && options.type.toUpperCase() === 'JSON') {\n      headers.set('content-type', 'application/json; charset=utf-8');\n      if (options.data != null) {\n        options.body = JSON.stringify(options.data);\n      }\n    } else if (options.type && options.type.toUpperCase() === 'FORM') {\n      headers.set('content-type', 'application/x-www-form-urlencoded; charset=utf-8');\n      if (options.data != null) {\n        options.body = queryString.stringify(options.data);\n      }\n    }\n  }\n\n  return fetch(url, options);\n};\n\n\nconst GET = async function GET (url, options) {\n  return fetchFactory((response) => {\n    return response;\n  })(url, Object.assign(options, {\n    method: 'GET'\n  }));\n};\n\nconst POST = async function POST (url, options) {\n  return fetchFactory((response) => {\n    return response;\n  })(url, Object.assign(options, {\n    method: 'POST'\n  }));\n};\n\nconst fetchBlob = async function fetchBlob (url, options) {\n  return fetchFactory((response) => {\n    return response.blob();\n  })(url, options);\n};\n\nconst fetchText = async function fetchText (url, options) {\n  return fetchFactory((response) => {\n    return response.text();\n  })(url, options);\n};\n\nconst fetchJSON = async function fetchJSON (url, options) {\n  return fetchFactory((response) => {\n    return response.json().then(json => checkCode(json));\n  })(url, options);\n};\n\nconst fetchArrayBuffer = async function fetchArrayBuffer (url, options) {\n  return fetchFactory((response) => {\n    return response.arrayBuffer();\n  })(url, options);\n};\n\nexport {\n  GET,\n  POST,\n  request,\n  fetchBlob,\n  fetchText,\n  fetchJSON,\n  fetchArrayBuffer\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/dao/dao.js","module.exports = require(\"babel-runtime/core-js/object/assign\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/assign\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/json/stringify\"\n// module id = 17\n// module chunks = 0","/**\n * @Desc:   常用基本工具类\n * @Author: yinzhida\n * @Email:  yinzhida@qiyi.com\n * @Date:   2018-02-11 16:44:02\n * @Last Modified by: zhaoxinxin\n * @Last Modified time: 2019-02-28 19:47:28\n */\nimport constants from '@/js/config/constants';\nimport { formatTime } from './time';\n\n/**\n * @description 判断json格式的fetch是否成功\n * @param  {Object} data [description]\n * @return {[type]}      [description]\n */\nconst isFetchSuccess = (data = {}) => {\n  const code = typeof data === 'string' ? data : data.code;\n  return code != null ? code === constants.SUCCESS_CODE : true;\n};\n\nconst hasAuth = (auth, cutomGlobal) => {\n  let global = cutomGlobal || window.GLOBAL || {};\n  let auths = global['AUTH_LIST'] || [];\n  return auths.includes(auth);\n};\n\n/**\n * @description 给数组内部对象某属性方法设置值\n */\nconst setObjArrayAttributeValue = (objArray, attributeName, attributeValue, index, singleValue) => {\n  for (let obj of objArray) {\n    obj[attributeName] = attributeValue;\n  }\n  if (index !== undefined && singleValue !== undefined) {\n    objArray[index][attributeName] = singleValue;\n  }\n};\n\n/**\n * @description 获取数组内部对象某属性为特定值的对象的索引值\n */\nconst getObjArrayAttributeIndexs = (objArray, attributeName, attributeValue) => {\n  let len = objArray.length;\n  let result = [];\n  for (let i = 0; i < len; i++) {\n    let obj = objArray[i];\n    if (obj[attributeName] === attributeValue) {\n      result.push(i);\n    }\n  }\n  return result;\n};\n\nconst closeWebPage = () => {\n  if (navigator.userAgent.indexOf('MSIE') > 0) {\n    if (navigator.userAgent.indexOf('MSIE 6.0') > 0) {\n      window.opener = null;\n      window.close();\n    } else {\n      window.open('', '_top');\n      window.top.close();\n    }\n  } else if (navigator.userAgent.indexOf('Firefox') > 0 || navigator.userAgent.indexOf('Chrome') > 0) {\n    window.location.href = 'about:blank';\n    window.close();\n  } else {\n    window.opener = null;\n    window.open('', '_self');\n    window.close();\n  }\n};\n/**\n * 生成从min-max之间的n个不重复随机数\n*/\nconst generateRandom = (n, min, max) => {\n  let a = [];\n\n  if (min > max) {\n    return [0];\n  }\n\n  for (let i = 0; i < n; i++) {\n    a.push(Math.floor(Math.random() * (max - min + 1)) + min);\n  }\n\n  a.sort(() => {\n    return 0.5 - Math.random();\n  });\n\n  return a;\n};\n\nexport {\n  isFetchSuccess,\n  hasAuth,\n  formatTime,\n  getObjArrayAttributeIndexs,\n  setObjArrayAttributeValue,\n  closeWebPage,\n  generateRandom\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/common-util.js","module.exports = require(\"query-string\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"query-string\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"lodash.merge\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.merge\"\n// module id = 20\n// module chunks = 0","/*\r\n * Created Date: 2018-03-17 11:17:37\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2019-10-31 16:15:23\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nimport getLogger from '@/js/utils/logger';\r\n\r\nconst instances = new Map();\r\nclass DataCache {\r\n  constructor (name, maxQueue) {\r\n    this.logger = getLogger('SrtEngine');\r\n    this.name = name || 'default';\r\n    if (instances.has(name)) {\r\n      this.logger.error('new DataCacheUtil', 'name is invalidate, ', name, 'have been used by others');\r\n      return;\r\n    }\r\n    this.dataCacheQueue = [];\r\n    this.maxCacheNumber = maxQueue || 10;\r\n    instances.set(this.name, this);\r\n  }\r\n\r\n  static getInstanceByname (name, maxQueue) {\r\n    if (instances.has(name)) {\r\n      return instances.get(name);\r\n    }\r\n    return new DataCache(name, maxQueue);\r\n  }\r\n\r\n  add (key, data) {\r\n    let queue = this.dataCacheQueue;\r\n    while (queue.length >= this.maxCacheNumber) {\r\n      queue.shift();\r\n    }\r\n    queue.push(new Map([[key, data]]));\r\n  }\r\n\r\n  clear () {\r\n    this.dataCacheQueue.length = 0;\r\n  }\r\n\r\n  getDataByKey (key) {\r\n    let dataMap = this.dataCacheQueue.find((map) => {\r\n      return map.has(key);\r\n    });\r\n    let data = dataMap && dataMap.get(key);\r\n    if (data) {\r\n      this.logger.info('cacheUtilGetData', 'get data success from cache, key: ', key);\r\n    } else {\r\n      this.logger.info('cacheUtilGetData', 'get data failed!!! from cache, key: ', key);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  getData (key) {\r\n    return this.getDataByKey(key);\r\n  }\r\n\r\n  deleteDataByKey (key) {\r\n    let index = this.dataCacheQueue.findIndex((dataMap) => {\r\n      dataMap.has(key);\r\n    });\r\n    if (index > -1) {\r\n      this.dataCacheQueue.splice(index, 1);\r\n    } else {\r\n      this.logger.warn('DataCacheUtil deleteDataByKey', 'data by key: ', key, ' not find!');\r\n    }\r\n  }\r\n}\r\nexport default DataCache;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/data-cache.js","module.exports = require(\"babel-runtime/core-js/map\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/map\"\n// module id = 22\n// module chunks = 0"],"sourceRoot":""}