{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 90631eb245407c002103","webpack:///external \"babel-runtime/regenerator\"","webpack:///external \"babel-runtime/helpers/asyncToGenerator\"","webpack:///external \"babel-runtime/helpers/classCallCheck\"","webpack:///external \"babel-runtime/helpers/createClass\"","webpack:///./src/js/utils/logger.js","webpack:///external \"babel-runtime/core-js/get-iterator\"","webpack:///external \"babel-runtime/core-js/object/assign\"","webpack:///./src/js/utils/time.js","webpack:///./src/js/utils/guid.js","webpack:///./src/js/config/constants.js","webpack:///./src/js/index.js","webpack:///./src/js/clazz/srt-engine.js","webpack:///./src/js/utils/single.js","webpack:///external \"lodash.clonedeep\"","webpack:///./src/js/utils/srt.js","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///./src/js/dao/dao.js","webpack:///external \"babel-runtime/core-js/json/stringify\"","webpack:///./src/js/utils/common-util.js","webpack:///external \"query-string\"","webpack:///external \"lodash.merge\"","webpack:///./src/js/utils/data-cache.js","webpack:///external \"babel-runtime/core-js/map\""],"names":["Logger","component","name","debug","process","log","method","data","Date","toUTCString","information","warning","warn","error","getLogger","getClassSingleton","formatTime","secondtime","formatString","frameRate","test","console","timeKey","regString","Math","floor","timeNumbers","getTimeNumbers","i","len","replace","RegExp","matchString","index","originalString","formatNumber","length","milli","frame","toFixed","timeArray","split","milliSecond","round","Number","hour","minute","second","totalSeconds","firstRemain","number","n","numberArray","unshift","res","join","__guid","newGUID","setGUID","uid","max","WILL_BUILD_INDEX_COUNT","UID_INDEX_GROUP_SIZE","ITME_INDEX_GROUP_DURATION","SEARCH_TEXT_USE_INDEX_MAX_RANGE","SrtEngine","shouldBuildIndex","logger","content","url","timeIndexGroup","uidIndexGroup","modified","originText","style","fontSize","fontColor","bold","italic","underground","align","clearSrtEngine","getSubtitleTextArrayByUrl","constants","buildIndex","text","getTextArrayFromText","maxUid","forEach","item","isNaN","map","undefined","clearIndex","styles","start","end","cutRange","isUsableNumber","result","getContent","dialogueStart","startTimeInMilliSeconds","dialogueEnd","endTimeInMilliSeconds","id","getStyledTexts","texts","supportStyles","value","serialize","getPureText","styleValue","_addToIndex","_addToTimeIndex","_addToUidIndex","_removeFromTimeIndex","_removeFromUidIndex","levelKey","getTimeLevelKey","endLevelKey","push","getUidLevelKey","currentGroup","dataIndex","findIndex","splice","currentEndGroup","endDataIndex","milliSecondtime","deleted","parseInt","word","searchResult","indexOf","find","duration","key","dialogue","cloneDeep","info","originData","needUpdateTimeIndex","findByUid","_updateDialog","filter","startIndex","endIndex","getInfos","targets","slice","sort","a","b","group","Clazz","arguments","getMilliSecondsFromString","timeStr","timeDivide","otherTimeStr","hmsArray","lineArray","marker","dataArray","timeArr","trim","Error","contentLineNumber","divideLineNumber","e","toString","cacheUtil","DataCache","getInstanceByname","textArray","getData","fetchBlob","then","blob","resolve","reject","reader","FileReader","onload","add","readAsText","checkCode","json","code","message","msg","isFetchSuccess","fetchFactory","options","startTime","now","performance","request","endTime","response","timing","trans","merge","mode","headers","Headers","toUpperCase","queryString","stringify","type","set","body","fetch","GET","POST","fetchText","fetchJSON","fetchArrayBuffer","arrayBuffer","SUCCESS_CODE","hasAuth","auth","cutomGlobal","global","window","GLOBAL","auths","includes","setObjArrayAttributeValue","objArray","attributeName","attributeValue","singleValue","obj","getObjArrayAttributeIndexs","closeWebPage","navigator","userAgent","opener","close","open","top","location","href","generateRandom","min","random","instances","maxQueue","has","dataCacheQueue","maxCacheNumber","queue","shift","dataMap","get","getDataByKey"],"mappings":"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","file":"srt-engine.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"srt-engine\"] = factory();\n\telse\n\t\troot[\"srt-engine\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 90631eb245407c002103","module.exports = require(\"babel-runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/regenerator\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/asyncToGenerator\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/classCallCheck\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/classCallCheck\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/createClass\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/createClass\"\n// module id = 3\n// module chunks = 0","/*\r\n * Created Date: 2018-03-01 11:14:20\r\n * Author: yinzhida Email: yinzhida@qiyi.com\r\n * -----\r\n * Last Modified: 2019-10-30 16:24:24\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nimport getClassSingleton from './single';\r\n\r\nclass Logger {\r\n  constructor (component) {\r\n    this.name = component;\r\n    this.debug = process.env.NODE_ENV !== 'production';\r\n  }\r\n\r\n  log (...args) {\r\n    if (this.debug) {\r\n      console.log(...args);\r\n    }\r\n  }\r\n\r\n  trans (method, ...data) {\r\n    this.log(`%c[Data Transmission][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > data: `, 'color: blue;', ...data);\r\n  }\r\n\r\n  info (method, ...information) {\r\n    this.log(`%c[Info][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > information: `, 'color: green;', ...information);\r\n  }\r\n\r\n  warn (method, ...warning) {\r\n    console.warn(`[Warning][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > warning: `, ...warning);\r\n  }\r\n\r\n  error (method, ...error) {\r\n    console.error(`[Error][${new Date().toUTCString()}] component: ${this.name} > method: ${method} > error: `, ...error);\r\n  }\r\n}\r\n\r\nconst getLogger = getClassSingleton(Logger);\r\n\r\nexport default getLogger;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/logger.js","module.exports = require(\"babel-runtime/core-js/get-iterator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/get-iterator\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"babel-runtime/core-js/object/assign\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/object/assign\"\n// module id = 6\n// module chunks = 0","/**\r\n * @Desc:   时间处理工具\r\n * @Author: yinzhida\r\n * @Email:  yinzhida@qiyi.com\r\n * @Date:   2018-02-27 15:42:44\r\n * @Last Modified by:   yinzhida\r\n * @Last Modified time: 2018-02-28 15:21:33\r\n */\r\n\r\n/**\r\n * 根据时间格式，将数字格式的时间转换为格式字符串\r\n * @param  {[type]} secondtime   [description]\r\n * @param  {[type]} formatString [description]\r\n * @return {[type]}              [description]\r\n */\r\nconst formatTime = (secondtime, formatString, frameRate) => {\r\n  formatString = formatString || 'hh:mm:ss S';\r\n\r\n  if (/SS+|FF+/.test(formatString)) {\r\n    console.error('formatTime', '毫秒格式错误，不能有多个连续的S或F出现');\r\n    return;\r\n  }\r\n\r\n  let timeKey = [{\r\n    name: 'hour',\r\n    regString: 'h+'\r\n  }, {\r\n    name: 'minute',\r\n    regString: 'm+'\r\n  }, {\r\n    name: 'second',\r\n    regString: 's+'\r\n  }];\r\n\r\n  if (!/S|F/.test(formatString)) {\r\n    secondtime = Math.floor(secondtime);\r\n  }\r\n\r\n  let timeNumbers = getTimeNumbers(secondtime, frameRate);\r\n\r\n  for (let i = 0, len = timeKey.length; i < len; i++) {\r\n    formatString = formatString.replace(new RegExp(timeKey[i].regString), function (matchString, index, originalString) {\r\n      return formatNumber(timeNumbers[timeKey[i].name], matchString.length);\r\n    });\r\n  }\r\n\r\n  // 毫秒只支持3位模式\r\n  formatString = formatString.replace(/S/, formatNumber(timeNumbers.milli, 3));\r\n  formatString = formatString.replace(/F/, formatNumber(timeNumbers.frame));\r\n  return formatString;\r\n};\r\n\r\n/**\r\n * 根据时间number获取小时，分钟，秒，毫秒数\r\n * @param  {[type]} secondtime [description]\r\n * @return {[type]}            [description]\r\n */\r\nconst getTimeNumbers = (secondtime, frameRate = 25) => {\r\n  // 转成字符串\r\n  secondtime = secondtime.toFixed(3);\r\n  // 从小数点切分\r\n  let timeArray = secondtime.split('.');\r\n  // 小数点后三位是毫秒部分\r\n  let milliSecond = 0;\r\n  let frame = 0;\r\n  if (timeArray[1]) {\r\n    milliSecond = Math.round(Number('0.' + timeArray[1]) * 1000);\r\n    frame = Math.floor(milliSecond / (1000 / frameRate));\r\n  }\r\n  // 分别获取时分秒\r\n  let hour = 0;\r\n  let minute = 0;\r\n  let second = 0;\r\n  // 一共多少秒\r\n  let totalSeconds = Number(timeArray[0]);\r\n  // 几个小时\r\n  hour = Math.floor(totalSeconds / 3600);\r\n  // 剩余秒数\r\n  let firstRemain = totalSeconds % 3600;\r\n  // 几分钟\r\n  minute = Math.floor(firstRemain / 60);\r\n  // 剩余秒数\r\n  second = firstRemain % 60;\r\n\r\n  let timeNumbers = {\r\n    hour: hour,\r\n    minute: minute,\r\n    second: second,\r\n    milli: milliSecond,\r\n    frame: frame\r\n  };\r\n\r\n  return timeNumbers;\r\n};\r\n\r\n/**\r\n * 数字格式化,在数字前边加0，补全到几位，比如输入1,3，则输出001\r\n * @param  {[type]} number [description]\r\n * @param  {[type]} n      [description]\r\n * @return {[type]}        [description]\r\n */\r\nconst formatNumber = (number, n) => {\r\n  n = n || 2;\r\n  number = number + '';\r\n  let numberArray = number.split('');\r\n\r\n  if (numberArray.length < n) {\r\n    let len = n - numberArray.length;\r\n    for (let i = 0; i < len; i++) {\r\n      numberArray.unshift('0');\r\n    }\r\n  }\r\n\r\n  let res = numberArray.join('');\r\n  return res;\r\n};\r\n\r\nexport {\r\n  formatTime,\r\n  getTimeNumbers,\r\n  formatNumber\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/time.js","/**\r\n * @file guid.js\r\n * @module guid\r\n */\r\n\r\n/**\r\n * Unique ID for an element or function\r\n * @type {Number}\r\n */\r\nlet __guid = 1;\r\n\r\n/**\r\n * Get a unique auto-incrementing ID by number that has not been returned before.\r\n *\r\n * @return {number}\r\n *         A new unique ID.\r\n */\r\nconst newGUID = function newGUID () {\r\n  return __guid++;\r\n};\r\n\r\nconst setGUID = function setGUID (uid) {\r\n  __guid = Math.max(__guid, uid);\r\n};\r\n\r\nexport {\r\n  newGUID,\r\n  setGUID\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/guid.js","\r\n\r\nexport default {\r\n  WILL_BUILD_INDEX_COUNT: 10,\r\n  UID_INDEX_GROUP_SIZE: 50,\r\n  ITME_INDEX_GROUP_DURATION: 1000 * 60 * 10, // 10分钟\r\n  SEARCH_TEXT_USE_INDEX_MAX_RANGE: 50 * 3 * 1000 // 150秒\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/config/constants.js","import SrtEngine from './clazz/srt-engine';\r\n\r\nexport {\r\n  SrtEngine,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/index.js","import getLogger from '@/js/utils/logger';\r\nimport { formatTime } from '@/js/utils/time';\r\nimport { newGUID, setGUID } from '@/js/utils/guid';\r\nimport constants from '@/js/config/constants';\r\nimport cloneDeep from 'lodash.clonedeep';\r\nimport { getSubtitleTextArrayByUrl, getTextArrayFromText, getPureText } from '@/js/utils/srt';\r\n\r\nclass SrtEngine {\r\n  constructor (shouldBuildIndex) {\r\n    this.logger = getLogger('SrtEngine');\r\n    this.content = [];\r\n    this.url = null;\r\n    this.shouldBuildIndex = typeof shouldBuildIndex === 'boolean' ? shouldBuildIndex : true;\r\n    this.timeIndexGroup = null;\r\n    this.uidIndexGroup = null;\r\n    this.modified = false;\r\n    this.originText = null;\r\n    this.style = {\r\n      fontSize: 16,\r\n      fontColor: '#ffffff',\r\n      bold: true,\r\n      italic: true,\r\n      underground: true,\r\n      // align default 2, values:\r\n      // 7, 8, 9\r\n      // 4, 5, 6\r\n      // 1, 2, 3\r\n      align: 2,\r\n    };\r\n  }\r\n\r\n  async load (url) {\r\n    this.clearSrtEngine();\r\n    this.url = url;\r\n    this.content = await getSubtitleTextArrayByUrl(url);\r\n    this.originText = this.content.originText;\r\n\r\n    if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n      this.buildIndex();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  compile (text) {\r\n    this.clearSrtEngine();\r\n    this.content = getTextArrayFromText(text);\r\n    this.originText = this.content.originText;\r\n    if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n      this.buildIndex();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  transform (content) {\r\n    this.clearSrtEngine();\r\n    let maxUid = 1;\r\n    this.content = content.forEach((item) => {\r\n      if (typeof item.uid === 'number' && !isNaN(item.uid)) {\r\n        maxUid = Math.max(item.uid, maxUid);\r\n      }\r\n    });\r\n    setGUID(maxUid + 1);\r\n    this.content = content.map((item) => {\r\n      item.uid = item.uid === undefined ? newGUID() : item.uid;\r\n      return item;\r\n    });\r\n    this.originText = null;\r\n    if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n      this.buildIndex();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  clearSrtEngine () {\r\n    this.url = '';\r\n    this.modified = false;\r\n    this.originText = null;\r\n    this.clearIndex();\r\n  }\r\n\r\n  setStyle (style) {\r\n    this.style = style;\r\n  }\r\n\r\n  getStyle () {\r\n    return this.style;\r\n  }\r\n\r\n  stringify (styles = {}, start, end) {\r\n    styles = Object.assign({}, this.style, styles);\r\n    start = Number(start);\r\n    end = Number(end);\r\n    let cutRange = false;\r\n    if (this.isUsableNumber(start) && this.isUsableNumber(end)) {\r\n      cutRange = true;\r\n    }\r\n\r\n    let result = '';\r\n    let content = this.getContent();\r\n    let len = content.length;\r\n    for (let i = 0; i < len; i++) {\r\n      let data = content[i];\r\n      let dialogueStart = data.startTimeInMilliSeconds;\r\n      let dialogueEnd = data.endTimeInMilliSeconds;\r\n\r\n      if (cutRange) {\r\n        if (data.endTimeInMilliSeconds <= start || data.startTimeInMilliSeconds >= end) {\r\n          continue;\r\n        }\r\n        dialogueStart = data.startTimeInMilliSeconds - start;\r\n        dialogueStart = dialogueStart < 0 ? 0 : dialogueStart;\r\n        dialogueEnd = data.endTimeInMilliSeconds - start;\r\n        dialogueEnd = dialogueEnd > (end - start) ? (end - start) : dialogueEnd;\r\n      }\r\n\r\n      let id = i + 1;\r\n      result += id + '\\n';\r\n      result += formatTime((dialogueStart / 1000), 'hh:mm:ss,S');\r\n      result += ' --> ';\r\n      result += formatTime((dialogueEnd / 1000), 'hh:mm:ss,S');\r\n      result += '\\n';\r\n      result += this.getStyledTexts(data.texts, styles).join('\\n') + '\\n\\n';\r\n    }\r\n    console.log(result);\r\n    return result;\r\n  }\r\n\r\n  getStyledTexts (texts, styles) {\r\n    const supportStyles = [{\r\n      name: 'fontColor',\r\n      method (text, value) {\r\n        return `<font color=\"${value}\">${text}</font>`;\r\n      }\r\n    }, {\r\n      name: 'fontSize',\r\n      method (text, value) {\r\n        if (/<font\\scolor=\"/.test(text)) {\r\n          return text.replace('<font', `<font size=${value}`);\r\n        } else {\r\n          return `<font size=\"${value}\">${text}</font>`;\r\n        }\r\n      }\r\n    }, {\r\n      name: 'bold',\r\n      method (text, value) {\r\n        return `<b>${text}</b>`;\r\n      }\r\n    }, {\r\n      name: 'italic',\r\n      method (text, value) {\r\n        return `<i>${text}</i>`;\r\n      }\r\n    }, {\r\n      name: 'underground',\r\n      method (text, value) {\r\n        return `<u>${text}</u>`;\r\n      }\r\n    }, {\r\n      name: 'align',\r\n      method (text, value) {\r\n        return `{\\\\an${value}}${text}`;\r\n      }\r\n    }];\r\n\r\n    const serialize = (text) => {\r\n      text = getPureText(text);\r\n      for (let style of supportStyles) {\r\n        let styleValue = styles[style.name];\r\n        if (styleValue) {\r\n          text = style.method(text, styleValue);\r\n        }\r\n      }\r\n      return text;\r\n    };\r\n\r\n    return texts.map(serialize);\r\n  }\r\n\r\n  clearIndex () {\r\n    this.timeIndexGroup = null;\r\n    this.uidIndexGroup = null;\r\n  }\r\n\r\n  buildIndex () {\r\n    const len = this.content.length;\r\n    this.timeIndexGroup = {};\r\n    this.uidIndexGroup = {};\r\n    for (let i = 0; i < len; i++) {\r\n      const data = this.content[i];\r\n      this._addToIndex(data);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  _addToIndex (data) {\r\n    this._addToTimeIndex(data);\r\n    this._addToUidIndex(data);\r\n  }\r\n\r\n  _removeFromIndex (data) {\r\n    this._removeFromTimeIndex(data);\r\n    this._removeFromUidIndex(data);\r\n  }\r\n\r\n  _addToTimeIndex (data) {\r\n    const levelKey = this.getTimeLevelKey(data.startTimeInMilliSeconds);\r\n    const endLevelKey = this.getTimeLevelKey(data.endTimeInMilliSeconds);\r\n    this.timeIndexGroup[levelKey] = this.timeIndexGroup[levelKey] || [];\r\n    this.timeIndexGroup[levelKey].push(data);\r\n    if (levelKey !== endLevelKey) {\r\n      this.timeIndexGroup[endLevelKey] = this.timeIndexGroup[endLevelKey] || [];\r\n      this.timeIndexGroup[endLevelKey].push(data);\r\n    }\r\n  }\r\n\r\n  _addToUidIndex (data) {\r\n    const levelKey = this.getUidLevelKey(data.uid);\r\n    this.uidIndexGroup[levelKey] = this.uidIndexGroup[levelKey] || [];\r\n    this.uidIndexGroup[levelKey].push(data);\r\n  }\r\n\r\n  _removeFromTimeIndex (data) {\r\n    const levelKey = this.getTimeLevelKey(data.startTimeInMilliSeconds);\r\n    const endLevelKey = this.getTimeLevelKey(data.endTimeInMilliSeconds);\r\n\r\n    let currentGroup = this.timeIndexGroup[levelKey];\r\n    let dataIndex = currentGroup.findIndex(item => item.uid === data.uid);\r\n    currentGroup.splice(dataIndex, 1);\r\n\r\n    if (levelKey !== endLevelKey) {\r\n      let currentEndGroup = this.timeIndexGroup[endLevelKey];\r\n      let endDataIndex = currentEndGroup.findIndex(item => item.uid === data.uid);\r\n      currentEndGroup.splice(endDataIndex, 1);\r\n    }\r\n  }\r\n\r\n  _removeFromUidIndex (data) {\r\n    let levelKey = this.getUidLevelKey(data.uid);\r\n    let currentGroup = this.uidIndexGroup[levelKey];\r\n    let dataIndex = currentGroup.findIndex(item => item.uid === data.uid);\r\n    currentGroup.splice(dataIndex, 1);\r\n  }\r\n\r\n  findByTime (milliSecondtime) {\r\n    let result = [];\r\n    if (this.timeIndexGroup) { // 通过索引查询\r\n      const levelKey = this.getTimeLevelKey(milliSecondtime);\r\n      this.timeIndexGroup[levelKey].forEach((item) => {\r\n        if (item.startTimeInMilliSeconds <= milliSecondtime &&\r\n          item.endTimeInMilliSeconds >= milliSecondtime &&\r\n          !item.deleted) {\r\n          result.push(item);\r\n        }\r\n      });\r\n    } else { // 直接轮询查询\r\n      let len = this.content.length;\r\n      for (let i = 0; i < len; i++) {\r\n        let data = this.content[i];\r\n        if (data.startTimeInMilliSeconds <= milliSecondtime &&\r\n          data.endTimeInMilliSeconds >= milliSecondtime &&\r\n          !data.deleted) {\r\n          result.push(data);\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  getTimeLevelKey (milliSecondtime) {\r\n    return parseInt(milliSecondtime / constants.ITME_INDEX_GROUP_DURATION);\r\n  }\r\n\r\n  getUidLevelKey (uid) {\r\n    return parseInt(uid / constants.UID_INDEX_GROUP_SIZE);\r\n  }\r\n\r\n  findByText (word) {\r\n    if (!word) {\r\n      return [];\r\n    }\r\n\r\n    let searchResult = [];\r\n    let len = this.content.length;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      let data = this.content[i];\r\n      if (!data.deleted && data.texts.join('\\n').indexOf(word) !== -1) {\r\n        searchResult.push(data);\r\n      }\r\n    }\r\n\r\n    return searchResult;\r\n  }\r\n\r\n  findByUid (uid) {\r\n    uid = Number(uid);\r\n    if (!this.isUsableNumber(uid)) {\r\n      return null;\r\n    }\r\n\r\n    if (this.uidIndexGroup) { // 通过索引查询\r\n      let levelKey = this.getUidLevelKey(uid);\r\n      return this.uidIndexGroup[levelKey].find((item) => {\r\n        return item.uid === uid && !item.deleted;\r\n      });\r\n    } else { // 直接轮询查询\r\n      let len = this.content.length;\r\n      for (let i = 0; i < len; i++) {\r\n        let data = this.content[i];\r\n        if (data.uid === uid && !data.deleted) {\r\n          return data;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  findByTimeRange (start, end) {\r\n    const duration = end - start;\r\n    if (duration < 0) {\r\n      return [];\r\n    }\r\n\r\n    let searchResult = [];\r\n    if (duration < constants.SEARCH_TEXT_USE_INDEX_MAX_RANGE &&\r\n      this.timeIndexGroup !== null) { // 使用索引\r\n      const levelKey = this.getTimeLevelKey(start);\r\n      const endLevelKey = this.getTimeLevelKey(end);\r\n      for (let key = levelKey; key <= endLevelKey; key++) {\r\n        for (let dialogue of this.timeIndexGroup[key]) {\r\n          if (!(dialogue.endTimeInMilliSeconds < start ||\r\n            dialogue.startTimeInMilliSeconds > end) && dialogue.deleted === false) {\r\n            searchResult.push(dialogue);\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // 直接查找\r\n      let len = this.content.length;\r\n      for (let i = 0; i < len; i++) {\r\n        let data = this.content[i];\r\n        if (!(data.endTimeInMilliSeconds < start ||\r\n          data.startTimeInMilliSeconds > end)) {\r\n          searchResult.push(data);\r\n        }\r\n      }\r\n    }\r\n\r\n    return searchResult;\r\n  }\r\n\r\n  addDialogue (dialogue, index) {\r\n    this.modified = true;\r\n    let uid = newGUID();\r\n    let data = Object.assign(cloneDeep(dialogue), {\r\n      uid: uid,\r\n    });\r\n\r\n    if (index !== undefined) {\r\n      this.content.splice(index, 0, data);\r\n    } else {\r\n      this.content.push(data);\r\n    }\r\n\r\n    if (this.timeIndexGroup !== null && this.uidIndexGroup !== null) {\r\n      this._addToIndex(data);\r\n    } else {\r\n      if (this.shouldBuildIndex && this.content.length > constants.WILL_BUILD_INDEX_COUNT) {\r\n        this.buildIndex();\r\n      }\r\n    }\r\n\r\n    return cloneDeep(data);\r\n  }\r\n\r\n  _updateDialog (dialogue, info) {\r\n    const originData = cloneDeep(dialogue);\r\n    let needUpdateTimeIndex = false;\r\n\r\n    if (this.isUsableNumber(info.startTimeInMilliSeconds)) {\r\n      needUpdateTimeIndex = true;\r\n      dialogue.startTimeInMilliSeconds = info.startTimeInMilliSeconds;\r\n    }\r\n\r\n    if (this.isUsableNumber(info.endTimeInMilliSeconds)) {\r\n      needUpdateTimeIndex = true;\r\n      dialogue.endTimeInMilliSeconds = info.endTimeInMilliSeconds;\r\n    }\r\n\r\n    if (info.texts) {\r\n      dialogue.texts = info.texts;\r\n    }\r\n\r\n    if (this.timeIndexGroup !== null && needUpdateTimeIndex) {\r\n      this._removeFromTimeIndex(originData);\r\n      this._addToTimeIndex(dialogue);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  updateDialogueByUid (uid, info) {\r\n    this.modified = true;\r\n    let data = this.findByUid(uid);\r\n    return this._updateDialog(data, info);\r\n  }\r\n\r\n  updateDialogByIndex (index, info) {\r\n    this.modified = true;\r\n    let content = this.content.filter(item => !item.deleted);\r\n    let data = content[index];\r\n    return this._updateDialog(data, info);\r\n  }\r\n\r\n  updateDialogueByRange (startIndex, endIndex, getInfos) {\r\n    let content = this.content.filter(item => !item.deleted);\r\n    let targets;\r\n    if (startIndex !== undefined) {\r\n      if (endIndex !== undefined) {\r\n        targets = content.slice(startIndex, endIndex);\r\n      } else {\r\n        targets = content.slice(startIndex);\r\n      }\r\n    }\r\n    targets.forEach((item) => {\r\n      let info = getInfos(item);\r\n      this._updateDialog(item, info);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  removeDialogueByUid (uid) {\r\n    this.modified = true;\r\n    let data = this.findByUid(uid);\r\n    data.deleted = true;\r\n    return this;\r\n  }\r\n\r\n  sort () {\r\n    this.modified = true;\r\n    this.content.sort((a, b) => {\r\n      return a.startTimeInMilliSeconds - b.startTimeInMilliSeconds;\r\n    });\r\n    for (let key in this.timeIndexGroup) {\r\n      const group = this.timeIndexGroup[key];\r\n      group.sort((a, b) => {\r\n        return a.startTimeInMilliSeconds - b.startTimeInMilliSeconds;\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getContent () {\r\n    let result = cloneDeep(this.content.filter(item => !item.deleted));\r\n    return result;\r\n  }\r\n\r\n  getOriginText () {\r\n    return this.originText;\r\n  }\r\n\r\n  isUsableNumber (value) {\r\n    if (value === undefined || value === null || isNaN(value)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default SrtEngine;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/clazz/srt-engine.js","/*\r\n * Created Date: 2018-03-15 10:23:03\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2019-03-26 18:25:51\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nconst getClassSingleton = function (Clazz) {\r\n  let result;\r\n  return function () {\r\n    return result || (result = new Clazz(arguments));\r\n  };\r\n};\r\n\r\nexport default getClassSingleton;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/single.js","module.exports = require(\"lodash.clonedeep\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.clonedeep\"\n// module id = 13\n// module chunks = 0","/*\r\n * Created Date: 2018-04-18 5:34:06\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2020-03-13 12:23:48\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\n\r\nimport { fetchBlob } from '@/js/dao/dao';\r\nimport DataCache from './data-cache';\r\nimport { newGUID } from './guid';\r\n\r\nconst getMilliSecondsFromString = (timeStr) => {\r\n  // 时间格式转换\r\n  let timeDivide = timeStr.split(',');\r\n  let milliSecond = Number(timeDivide[1]);\r\n  let otherTimeStr = timeDivide[0];\r\n  let hmsArray = otherTimeStr.split(':');\r\n  milliSecond = hmsArray[0] * 60 * 60 * 1000 + hmsArray[1] * 60 * 1000 + hmsArray[2] * 1000 + milliSecond;\r\n  return milliSecond;\r\n};\r\n\r\nconst getPureText = (text) => {\r\n  if (!text) {\r\n    return '';\r\n  }\r\n  return text.replace(/{\\\\.*?}/g, '').replace(/<\\/?.*?>/g, '');\r\n};\r\n\r\nconst getTextArrayFromText = (text) => {\r\n  let lineArray = text.split('\\n');\r\n  try {\r\n    // 一条字幕的开始点\r\n    let marker = 0;\r\n    let dataArray = [];\r\n    dataArray.originText = text;\r\n    for (let i = 0; i < lineArray.length; i++) {\r\n      // here is a start point of data\r\n      if (i === marker) {\r\n        // default timeString\r\n        let timeArr = ['00:00:00,000', '00:00:00,000'];\r\n        if ((i + 1) >= lineArray.length) {\r\n          return dataArray;\r\n        }\r\n\r\n        let timeStr = lineArray[i + 1];\r\n        if (timeStr !== '') {\r\n          timeArr = timeStr.trim().split(/\\s+/).filter((item) => {\r\n            return /\\d{1,2}:\\d{1,2}:\\d{1,2},\\d{1,3}/.test(item);\r\n          });\r\n        }\r\n\r\n        let data = {\r\n          uid: newGUID(),\r\n          id: lineArray[i].trim(), // id\r\n          startTimeInMilliSeconds: getMilliSecondsFromString(timeArr[0]), // 根据字幕里的事件字符串，获取开始结束的以毫秒计数的时间点\r\n          endTimeInMilliSeconds: getMilliSecondsFromString(timeArr[1]), // 根据字幕里的事件字符串，获取开始结束的以毫秒计数的时间点\r\n          texts: [] // subtitle content,may have several lines\r\n        };\r\n\r\n        // 如果这些数据有误，说明这个字幕文件格式不太对。\r\n        if (isNaN(data.id) || isNaN(data.startTimeInMilliSeconds) || isNaN(data.endTimeInMilliSeconds)) {\r\n          throw new Error('字幕文件的内容，格式有误！');\r\n        }\r\n\r\n        // now point to the content line i+2，就是说id和时间后边，是这个字幕的内容，这部分是从第三行开始\r\n        let contentLineNumber = 2;\r\n        if ((i + contentLineNumber) >= lineArray.length) {\r\n          data.texts.push('');\r\n          dataArray.push(data);\r\n          return dataArray;\r\n        }\r\n\r\n        // 当然这个字幕到底是有一行字幕还是有两行或者三行字幕都不好说，所以做一下循环，看看到底有几行\r\n        // if line i+2 have words, then it must be the subtitle contentline. and we should find it's next line, util we get a '', another case is there is'nt content line.\r\n        while (lineArray[i + contentLineNumber].trim() !== '') {\r\n          data.texts.push(getPureText(lineArray[i + contentLineNumber]).trim());\r\n          contentLineNumber++;\r\n          if ((i + contentLineNumber) >= lineArray.length) {\r\n            data.texts.push('');\r\n            dataArray.push(data);\r\n            return dataArray;\r\n          }\r\n        }\r\n\r\n        // 查找完字幕内容，就该来分析一下，这句字幕是不是结束啦，后边空行是不是有多于一行，然后计算出下一句字幕的开始位置（marker）。\r\n        // now we know at the index 'i+contentLineNumber' we get a '', so we should see the next line 'i+contentLineNumber+1' until we get some words.\r\n        let divideLineNumber = i + contentLineNumber + 1;\r\n        if (divideLineNumber >= lineArray.length) {\r\n          marker = 0;\r\n          dataArray.push(data);\r\n          return dataArray;\r\n        }\r\n\r\n        // 这个地方空行可能也不止一行，不过按理说应该是一行才对。\r\n        while (lineArray[divideLineNumber].trim() === '') {\r\n          divideLineNumber++;\r\n          if (divideLineNumber >= lineArray.length) {\r\n            marker = 0;\r\n            dataArray.push(data);\r\n            return dataArray;\r\n          }\r\n        }\r\n\r\n        // here we got a new marker point.\r\n        marker = divideLineNumber;\r\n        i = divideLineNumber - 1;\r\n        dataArray.push(data);\r\n      }\r\n    }\r\n    return dataArray;\r\n  } catch (e) {\r\n    console.error('getTextArrayFromText', '解析文件出错，文件格式可能不正确。', e.toString());\r\n    return [];\r\n  }\r\n};\r\n\r\nconst getSubtitleTextArrayByUrl = async (url) => {\r\n  let cacheUtil = DataCache.getInstanceByname('subtitleText', 2);\r\n  let textArray = cacheUtil.getData(url);\r\n\r\n  if (textArray) {\r\n    return textArray;\r\n  }\r\n\r\n  let result = await fetchBlob(url).then((blob) => {\r\n    return new Promise((resolve, reject) => {\r\n      let reader = new FileReader();\r\n      reader.onload = function (e) {\r\n        let text = reader.result;\r\n        let textArray = getTextArrayFromText(text);\r\n        let cacheUtil = DataCache.getInstanceByname('subtitleText', 2);\r\n        cacheUtil.add(url, textArray);\r\n        resolve(textArray);\r\n      };\r\n      reader.readAsText(blob, 'UTF-8');\r\n    });\r\n  });\r\n  return result;\r\n};\r\n\r\nexport {\r\n  getMilliSecondsFromString,\r\n  getPureText,\r\n  getTextArrayFromText,\r\n  getSubtitleTextArrayByUrl,\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/srt.js","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/promise\"\n// module id = 15\n// module chunks = 0","/**\n * @Desc:   Http Utils in video-editor\n * @Author: yinzhida\n * @Email:  yinzhida@qiyi.com\n * @Date:   2018-02-09 17:59:45\n * @Last Modified by:   yinzhida\n * @Last Modified time: 2018-02-28 15:05:14\n */\nimport { isFetchSuccess } from '@/js/utils/common-util';\nimport getLogger from '@/js/utils/logger';\nimport queryString from 'query-string';\nimport merge from 'lodash.merge';\n\n\nfunction checkCode (json) {\n  let code = json.code;\n  let message = json.msg || 'error';\n\n  if (isFetchSuccess(code)) {\n    return json;\n  } else {\n    const logger = getLogger('SrtEngine');\n    logger.error('checkCode', 'Server error: ', code, ', message: ', message);\n  }\n}\n\nfunction fetchFactory (process) {\n  return async function (url, options) {\n    const startTime = Date.now() && performance && performance.now();\n    let result = await request(url, options).then(response => {\n      const endTime = Date.now() && performance && performance.now();\n      response.timing = endTime - startTime;\n      const logger = getLogger('SrtEngine');\n      logger.trans('fetchFactory', response);\n      if (process) {\n        return process(response);\n      }\n\n      return response;\n    });\n    return result;\n  };\n}\n\nconst request = async function request (url, options = {}) {\n  options = merge({\n    method: 'GET',\n    mode: 'cors',\n    headers: new Headers()\n  }, options);\n\n  if (options.method.toUpperCase() === 'GET') {\n    if (options.data != null) {\n      url = url + '?' + queryString.stringify(options.data);\n    }\n  } else if (options.method.toUpperCase() === 'POST') {\n    let headers = options.headers;\n\n    if (options.type && options.type.toUpperCase() === 'JSON') {\n      headers.set('content-type', 'application/json; charset=utf-8');\n      if (options.data != null) {\n        options.body = JSON.stringify(options.data);\n      }\n    } else if (options.type && options.type.toUpperCase() === 'FORM') {\n      headers.set('content-type', 'application/x-www-form-urlencoded; charset=utf-8');\n      if (options.data != null) {\n        options.body = queryString.stringify(options.data);\n      }\n    }\n  }\n\n  return fetch(url, options);\n};\n\n\nconst GET = async function GET (url, options) {\n  return fetchFactory((response) => {\n    return response;\n  })(url, Object.assign(options, {\n    method: 'GET'\n  }));\n};\n\nconst POST = async function POST (url, options) {\n  return fetchFactory((response) => {\n    return response;\n  })(url, Object.assign(options, {\n    method: 'POST'\n  }));\n};\n\nconst fetchBlob = async function fetchBlob (url, options) {\n  return fetchFactory((response) => {\n    return response.blob();\n  })(url, options);\n};\n\nconst fetchText = async function fetchText (url, options) {\n  return fetchFactory((response) => {\n    return response.text();\n  })(url, options);\n};\n\nconst fetchJSON = async function fetchJSON (url, options) {\n  return fetchFactory((response) => {\n    return response.json().then(json => checkCode(json));\n  })(url, options);\n};\n\nconst fetchArrayBuffer = async function fetchArrayBuffer (url, options) {\n  return fetchFactory((response) => {\n    return response.arrayBuffer();\n  })(url, options);\n};\n\nexport {\n  GET,\n  POST,\n  request,\n  fetchBlob,\n  fetchText,\n  fetchJSON,\n  fetchArrayBuffer\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/dao/dao.js","module.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/json/stringify\"\n// module id = 17\n// module chunks = 0","/**\n * @Desc:   常用基本工具类\n * @Author: yinzhida\n * @Email:  yinzhida@qiyi.com\n * @Date:   2018-02-11 16:44:02\n * @Last Modified by: zhaoxinxin\n * @Last Modified time: 2019-02-28 19:47:28\n */\nimport constants from '@/js/config/constants';\nimport { formatTime } from './time';\n\n/**\n * @description 判断json格式的fetch是否成功\n * @param  {Object} data [description]\n * @return {[type]}      [description]\n */\nconst isFetchSuccess = (data = {}) => {\n  const code = typeof data === 'string' ? data : data.code;\n  return code != null ? code === constants.SUCCESS_CODE : true;\n};\n\nconst hasAuth = (auth, cutomGlobal) => {\n  let global = cutomGlobal || window.GLOBAL || {};\n  let auths = global['AUTH_LIST'] || [];\n  return auths.includes(auth);\n};\n\n/**\n * @description 给数组内部对象某属性方法设置值\n */\nconst setObjArrayAttributeValue = (objArray, attributeName, attributeValue, index, singleValue) => {\n  for (let obj of objArray) {\n    obj[attributeName] = attributeValue;\n  }\n  if (index !== undefined && singleValue !== undefined) {\n    objArray[index][attributeName] = singleValue;\n  }\n};\n\n/**\n * @description 获取数组内部对象某属性为特定值的对象的索引值\n */\nconst getObjArrayAttributeIndexs = (objArray, attributeName, attributeValue) => {\n  let len = objArray.length;\n  let result = [];\n  for (let i = 0; i < len; i++) {\n    let obj = objArray[i];\n    if (obj[attributeName] === attributeValue) {\n      result.push(i);\n    }\n  }\n  return result;\n};\n\nconst closeWebPage = () => {\n  if (navigator.userAgent.indexOf('MSIE') > 0) {\n    if (navigator.userAgent.indexOf('MSIE 6.0') > 0) {\n      window.opener = null;\n      window.close();\n    } else {\n      window.open('', '_top');\n      window.top.close();\n    }\n  } else if (navigator.userAgent.indexOf('Firefox') > 0 || navigator.userAgent.indexOf('Chrome') > 0) {\n    window.location.href = 'about:blank';\n    window.close();\n  } else {\n    window.opener = null;\n    window.open('', '_self');\n    window.close();\n  }\n};\n/**\n * 生成从min-max之间的n个不重复随机数\n*/\nconst generateRandom = (n, min, max) => {\n  let a = [];\n\n  if (min > max) {\n    return [0];\n  }\n\n  for (let i = 0; i < n; i++) {\n    a.push(Math.floor(Math.random() * (max - min + 1)) + min);\n  }\n\n  a.sort(() => {\n    return 0.5 - Math.random();\n  });\n\n  return a;\n};\n\nexport {\n  isFetchSuccess,\n  hasAuth,\n  formatTime,\n  getObjArrayAttributeIndexs,\n  setObjArrayAttributeValue,\n  closeWebPage,\n  generateRandom\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/common-util.js","module.exports = require(\"query-string\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"query-string\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"lodash.merge\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.merge\"\n// module id = 20\n// module chunks = 0","/*\r\n * Created Date: 2018-03-17 11:17:37\r\n * Author: yinzhida Email: zhaoxinxin@qiyi.com\r\n * -----\r\n * Last Modified: 2019-10-31 16:15:23\r\n * Modified By: yinzhida yinzhida@qiyi.com\r\n * -----\r\n * Copyright (c) 2018 IQIYI\r\n */\r\nimport getLogger from '@/js/utils/logger';\r\n\r\nconst instances = new Map();\r\nclass DataCache {\r\n  constructor (name, maxQueue) {\r\n    this.logger = getLogger('SrtEngine');\r\n    this.name = name || 'default';\r\n    if (instances.has(name)) {\r\n      this.logger.error('new DataCacheUtil', 'name is invalidate, ', name, 'have been used by others');\r\n      return;\r\n    }\r\n    this.dataCacheQueue = [];\r\n    this.maxCacheNumber = maxQueue || 10;\r\n    instances.set(this.name, this);\r\n  }\r\n\r\n  static getInstanceByname (name, maxQueue) {\r\n    if (instances.has(name)) {\r\n      return instances.get(name);\r\n    }\r\n    return new DataCache(name, maxQueue);\r\n  }\r\n\r\n  add (key, data) {\r\n    let queue = this.dataCacheQueue;\r\n    while (queue.length >= this.maxCacheNumber) {\r\n      queue.shift();\r\n    }\r\n    queue.push(new Map([[key, data]]));\r\n  }\r\n\r\n  clear () {\r\n    this.dataCacheQueue.length = 0;\r\n  }\r\n\r\n  getDataByKey (key) {\r\n    let dataMap = this.dataCacheQueue.find((map) => {\r\n      return map.has(key);\r\n    });\r\n    let data = dataMap && dataMap.get(key);\r\n    if (data) {\r\n      this.logger.info('cacheUtilGetData', 'get data success from cache, key: ', key);\r\n    } else {\r\n      this.logger.info('cacheUtilGetData', 'get data failed!!! from cache, key: ', key);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  getData (key) {\r\n    return this.getDataByKey(key);\r\n  }\r\n\r\n  deleteDataByKey (key) {\r\n    let index = this.dataCacheQueue.findIndex((dataMap) => {\r\n      dataMap.has(key);\r\n    });\r\n    if (index > -1) {\r\n      this.dataCacheQueue.splice(index, 1);\r\n    } else {\r\n      this.logger.warn('DataCacheUtil deleteDataByKey', 'data by key: ', key, ' not find!');\r\n    }\r\n  }\r\n}\r\nexport default DataCache;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/data-cache.js","module.exports = require(\"babel-runtime/core-js/map\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/core-js/map\"\n// module id = 22\n// module chunks = 0"],"sourceRoot":""}